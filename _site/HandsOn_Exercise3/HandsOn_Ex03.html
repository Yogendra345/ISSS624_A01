<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yogendra Shinde">

<title>ISSS624_A01 - Hands_On_Ex3 Geographical Segmentation with Spatially Constrained Clustering Techniques</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS624_A01</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">Hands-on Exercise</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../HandsOn_Exercise1/HandsOn_Exercise1.html">
 <span class="dropdown-text">Hands-On_Ex01 : Geospatial Data Wrangling with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../HandsOn_Exercise2/HandsOn_Ex02.html">
 <span class="dropdown-text">Hands-On_Ex02 : Choropleth Mapping with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../HandsOn_Exercise3/HandsOn_Ex03.html">
 <span class="dropdown-text">Hands_On_Ex3 Geographical Segmentation with Spatially Constrained Clustering Techniques</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../HandsOn_Exercise4/HandsOn_Ex04.html">
 <span class="dropdown-text">HandsOn_Ex04 : Calibrating Hedonic Pricing Model for Private Highrise Property with GWR Method.</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">In Class Exercise</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li class="dropdown-header">InClass Exercise Hunan Case Study.</li>
        <li>
    <a class="dropdown-item" href="../InClass_Ex01/InClass_Hunan.html">
 <span class="dropdown-text">InClass_Ex01 : Spatial Weights and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../InClass_Ex03/InClass_Ex03.html">
 <span class="dropdown-text">InClass_Ex03 : Calibrating Hedonic Pricing Model for Private Highrise Property with GWR Method.</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">Take Home Exercise</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../InClass_Ex02/Africa_Water/Take_Home_Ex1.html">
 <span class="dropdown-text">Take Home Ex 1 : Nigeria Water Functional &amp; Non Functional Water Points</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../TakeHome_Ex02/TakeHome_Ex02.html">
 <span class="dropdown-text">Take Home Ex 2 : Regionalization of Multivariate Water Point Attributes with Non-spatially Constrained and Spatially Constrained Clustering Methods.</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1. Overview</a>
  <ul class="collapse">
  <li><a href="#learning-outcome." id="toc-learning-outcome." class="nav-link" data-scroll-target="#learning-outcome.">1.1 Learning Outcome.</a>
  <ul class="collapse">
  <li><a href="#exercise-objective-the-analytical-question." id="toc-exercise-objective-the-analytical-question." class="nav-link" data-scroll-target="#exercise-objective-the-analytical-question.">1.2 Exercise Objective &amp; The Analytical Question.</a></li>
  <li><a href="#installing-and-loading-r-packages." id="toc-installing-and-loading-r-packages." class="nav-link" data-scroll-target="#installing-and-loading-r-packages.">1.3 Installing and loading R packages.</a></li>
  </ul></li>
  <li><a href="#data-import-and-preparation." id="toc-data-import-and-preparation." class="nav-link" data-scroll-target="#data-import-and-preparation.">2. Data Import and Preparation.</a>
  <ul class="collapse">
  <li><a href="#import-geospatial-data." id="toc-import-geospatial-data." class="nav-link" data-scroll-target="#import-geospatial-data.">2.1 Import Geospatial Data.</a></li>
  <li><a href="#importing-aspatial-data-into-r-environment." id="toc-importing-aspatial-data-into-r-environment." class="nav-link" data-scroll-target="#importing-aspatial-data-into-r-environment.">2.2 Importing aspatial data into R environment.</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis." id="toc-exploratory-data-analysis." class="nav-link" data-scroll-target="#exploratory-data-analysis.">3. Exploratory Data Analysis.</a></li>
  <li><a href="#eda-using-choropleth-map." id="toc-eda-using-choropleth-map." class="nav-link" data-scroll-target="#eda-using-choropleth-map.">4. EDA using Choropleth map.</a>
  <ul class="collapse">
  <li><a href="#joining-aspatial-data-with-geospatial-data." id="toc-joining-aspatial-data-with-geospatial-data." class="nav-link" data-scroll-target="#joining-aspatial-data-with-geospatial-data.">4.1 Joining aspatial data with geospatial data.</a></li>
  <li><a href="#preparing-choropleth-map." id="toc-preparing-choropleth-map." class="nav-link" data-scroll-target="#preparing-choropleth-map.">4.2 Preparing Choropleth Map.</a></li>
  </ul></li>
  <li><a href="#correlation-analysis." id="toc-correlation-analysis." class="nav-link" data-scroll-target="#correlation-analysis.">5. Correlation Analysis.</a></li>
  <li><a href="#hierarchy-cluster-analysis." id="toc-hierarchy-cluster-analysis." class="nav-link" data-scroll-target="#hierarchy-cluster-analysis.">6. Hierarchy Cluster Analysis.</a>
  <ul class="collapse">
  <li><a href="#extracting-clustering-variables." id="toc-extracting-clustering-variables." class="nav-link" data-scroll-target="#extracting-clustering-variables.">6.1 Extracting clustering variables.</a></li>
  </ul></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a>
  <ul class="collapse">
  <li><a href="#data-standardization." id="toc-data-standardization." class="nav-link" data-scroll-target="#data-standardization.">6.2 Data Standardization.</a></li>
  <li><a href="#visualizing-the-standardized-clustering-variables." id="toc-visualizing-the-standardized-clustering-variables." class="nav-link" data-scroll-target="#visualizing-the-standardized-clustering-variables.">6.3 Visualizing the standardized clustering variables.</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#computing-hierarchical-clustering." id="toc-computing-hierarchical-clustering." class="nav-link" data-scroll-target="#computing-hierarchical-clustering.">6.5 Computing hierarchical clustering.</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a></li>
  <li><a href="#interpreting-the-dendrograms." id="toc-interpreting-the-dendrograms." class="nav-link" data-scroll-target="#interpreting-the-dendrograms.">6.7.2 Interpreting the dendrograms.</a></li>
  <li><a href="#visually-driven-hierarchical-clustering-analysis." id="toc-visually-driven-hierarchical-clustering-analysis." class="nav-link" data-scroll-target="#visually-driven-hierarchical-clustering-analysis.">6.7.3 Visually-driven hierarchical clustering analysis.</a></li>
  </ul></li>
  <li><a href="#spatially-constrained-clustering-skater-approach." id="toc-spatially-constrained-clustering-skater-approach." class="nav-link" data-scroll-target="#spatially-constrained-clustering-skater-approach.">7. Spatially Constrained Clustering: SKATER approach.</a>
  <ul class="collapse">
  <li><a href="#converting-into-spatialpolygonsdataframe" id="toc-converting-into-spatialpolygonsdataframe" class="nav-link" data-scroll-target="#converting-into-spatialpolygonsdataframe">7.1 Converting into SpatialPolygonsDataFrame</a></li>
  <li><a href="#computing-neighbour-list." id="toc-computing-neighbour-list." class="nav-link" data-scroll-target="#computing-neighbour-list.">7.2 Computing Neighbour List.</a></li>
  <li><a href="#computing-minimum-spanning-tree." id="toc-computing-minimum-spanning-tree." class="nav-link" data-scroll-target="#computing-minimum-spanning-tree.">7.3 Computing minimum spanning tree.</a></li>
  <li><a href="#computing-spatially-constrained-clusters-using-skater-method." id="toc-computing-spatially-constrained-clusters-using-skater-method." class="nav-link" data-scroll-target="#computing-spatially-constrained-clusters-using-skater-method.">7.4 Computing spatially constrained clusters using SKATER method.</a></li>
  <li><a href="#visualizing-the-clusters-in-choropleth-map." id="toc-visualizing-the-clusters-in-choropleth-map." class="nav-link" data-scroll-target="#visualizing-the-clusters-in-choropleth-map.">7.5 Visualizing the clusters in choropleth map.</a></li>
  </ul></li>
  <li><a href="#spatially-constrained-clustering-clustgeo-method." id="toc-spatially-constrained-clustering-clustgeo-method." class="nav-link" data-scroll-target="#spatially-constrained-clustering-clustgeo-method.">8. Spatially Constrained Clustering: ClustGeo Method.</a>
  <ul class="collapse">
  <li><a href="#ward-like-hierarchical-clustering-clustgeo." id="toc-ward-like-hierarchical-clustering-clustgeo." class="nav-link" data-scroll-target="#ward-like-hierarchical-clustering-clustgeo.">8.1 Ward-like hierarchical clustering: ClustGeo.</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5"></a></li>
  <li><a href="#mapping-the-clusters-formed.-1" id="toc-mapping-the-clusters-formed.-1" class="nav-link" data-scroll-target="#mapping-the-clusters-formed.-1">8.2 Mapping the clusters formed.</a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6"></a></li>
  </ul></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8"></a>
  <ul class="collapse">
  <li><a href="#multivariate-visualisation" id="toc-multivariate-visualisation" class="nav-link" data-scroll-target="#multivariate-visualisation">9.1 Multivariate Visualisation</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hands_On_Ex3 Geographical Segmentation with Spatially Constrained Clustering Techniques</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yogendra Shinde </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>1. Overview</h1>
<p>In this hands-on exercise, we will gain hands-on experience on how to delineate homogeneous region by using geographically referenced multivariate data. There are two major analysis, namely:</p>
<ol type="1">
<li><p>Hierarchical cluster analysis and</p></li>
<li><p>Spatially constrained cluster analysis</p></li>
</ol>
<section id="learning-outcome." class="level2">
<h2 class="anchored" data-anchor-id="learning-outcome.">1.1 Learning Outcome.</h2>
<p>By the end of this hands-on exercise, we will able:</p>
<ul>
<li><p>to convert GIS polygon data into R’s simple feature data.frame by using appropriate functions of <strong>sf</strong> package of R</p></li>
<li><p>to convert simple feature data.frame into R’s SpatialPolygonDataFrame object by using appropriate <strong>sf</strong> of package of R;</p></li>
<li><p>to perform cluster analysis by using <em>hclust()</em> of Base R;</p></li>
<li><p>to perform spatially constrained cluster analysis using <em>skater()</em> of Base R; and</p></li>
<li><p>to visualise the analysis output by using <strong>ggplot2</strong> and <strong>tmap</strong> package.</p></li>
</ul>
<section id="exercise-objective-the-analytical-question." class="level3">
<h3 class="anchored" data-anchor-id="exercise-objective-the-analytical-question.">1.2 Exercise Objective &amp; The Analytical Question.</h3>
<p>In geobusiness and spatial policy, it is a common practice to delineate the market or planning area into homogeneous regions by using multivariate data. In this hands-on exercise, we are interested to delineate <a href="https://en.wikipedia.org/wiki/Shan_State">Shan State</a>, <a href="https://en.wikipedia.org/wiki/Myanmar">Myanmar</a> into <strong><em>homogeneous regions</em></strong> by using multiple Information and Communication technology (ICT) measures, namely: Radio, Television, Land line phone, Mobile phone, Computer, and Internet at home. (which is multi-variate analysis)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/inle%20lake.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Inle Lake, Shan State Myanmar. Photo by flickr</figcaption><p></p>
</figure>
</div>
</section>
<section id="installing-and-loading-r-packages." class="level3">
<h3 class="anchored" data-anchor-id="installing-and-loading-r-packages.">1.3 Installing and loading R packages.</h3>
<p>Before we get started, it is important for us to install required packages in R environment.</p>
<p>Following R packages will be loaded</p>
<ul>
<li><p>For spatial data handling –&gt; <strong>sf , sgdal</strong> and <strong>spdep</strong></p></li>
<li><p>Attribute data handling -&gt; <strong>tidyverse , readr , ggplot2</strong> and <strong>dplyr</strong></p></li>
<li><p>Choropleth Mapping -&gt; tmap</p></li>
<li><p>Multivariate data visualization and analysis -&gt; corrplot, ggpubr and heatmaply</p></li>
<li><p>Cluster Analysis -&gt; cluster and ClustGeo</p></li>
</ul>
<p>Code chunk below installs and launches theses packages in R environment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span> <span class="fu">p_load</span>(rgdal,spdep,tmap, sf,ClustGeo,ggpubr,cluster, factoextra,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                NbClust,heatmaply,corrplot,psych,tidyverse, knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-import-and-preparation." class="level2">
<h2 class="anchored" data-anchor-id="data-import-and-preparation.">2. Data Import and Preparation.</h2>
<section id="import-geospatial-data." class="level3">
<h3 class="anchored" data-anchor-id="import-geospatial-data.">2.1 Import Geospatial Data.</h3>
<p>Here we import Myanmar Township Boundary GIS data &amp; its associated attribute table into R environment.</p>
<p>The Myanmar Township Boundary data is in ESRI format and it will be imported into R environment by using <strong><em>st_read()</em></strong> function of <strong><em>sf</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>shan_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"myanmar_township_boundaries"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `myanmar_township_boundaries' from data source 
  `C:\Yogendra345\ISSS624_A01\HandsOn_Exercise3\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 330 features and 14 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.17275 ymin: 9.671252 xmax: 101.1699 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>shan_sf_ST <span class="ot">&lt;-</span> shan_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ST <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Shan (East)"</span>, <span class="st">"Shan (Earth)"</span>, <span class="st">"Shan (South)"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The imported township boundary object is called <strong><em>shan_sf_ST</em></strong>. It is saved in <strong>simple feature data.frame</strong> format. We can view the content of the newly created <strong><em>shan_sf</em>_ST</strong> simple features data.frame by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>shan_sf_ST</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 31 features and 14 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 96.20361 ymin: 19.29932 xmax: 101.1699 ymax: 22.26853
Geodetic CRS:  WGS 84
First 10 features:
   OBJECTID           ST ST_PCODE       DT   DT_PCODE       TS  TS_PCODE
1       203 Shan (South)   MMR014 Taunggyi MMR014D001  Pindaya MMR014006
2       240 Shan (South)   MMR014 Taunggyi MMR014D001  Ywangan MMR014007
3       106 Shan (South)   MMR014 Taunggyi MMR014D001 Pinlaung MMR014009
4        40 Shan (South)   MMR014 Taunggyi MMR014D001    Kalaw MMR014005
5       194 Shan (South)   MMR014 Taunggyi MMR014D001    Pekon MMR014010
6       159 Shan (South)   MMR014 Taunggyi MMR014D001 Lawksawk MMR014008
7       155 Shan (South)   MMR014   Loilen MMR014D002   Laihka MMR014012
8       101 Shan (South)   MMR014  Langkho MMR014D003  Mongnai MMR014019
9       105 Shan (South)   MMR014  Langkho MMR014D003  Mawkmai MMR014020
10        0  Shan (East)   MMR016 Monghsat MMR016D002  Mongton MMR016008
                 ST_2           LABEL2 SELF_ADMIN ST_RG T_NAME_WIN T_NAME_M3
1  Shan State (South)   Pindaya\n77769       Danu State     yif;w,     ပင်းတယ
2  Shan State (South)   Ywangan\n76933       Danu State      &amp;GmiH       ရွာငံ
3  Shan State (South) Pinlaung\n162537       Pa-O State  yifavmif;   ပင်လောင်း
4  Shan State (South)    Kalaw\n163138       &lt;NA&gt; State       uavm      ကလော
5  Shan State (South)     Pekon\n94226       &lt;NA&gt; State     z,fcHk       ဖယ်ခုံ
6  Shan State (South)         Lawksawk       &lt;NA&gt; State   &amp;yfapmuf    ရပ်စောက်
7  Shan State (South)    Laihka\n44329       &lt;NA&gt; State     vJcsm;     လဲချား
8  Shan State (South)   Mongnai\n25019       &lt;NA&gt; State     rdk;eJ       မိုးနဲ
9  Shan State (South)   Mawkmai\n24860       &lt;NA&gt; State   armufr,f    မောက်မယ်
10  Shan State (East)   Mongton\n49143       &lt;NA&gt; State  rdkif;wHk      မိုင်းတုံ
       AREA                       geometry
1   629.025 MULTIPOLYGON (((96.7731 21....
2  2984.377 MULTIPOLYGON (((96.78483 21...
3  3396.963 MULTIPOLYGON (((96.49518 20...
4  1456.624 MULTIPOLYGON (((96.49518 20...
5  2073.513 MULTIPOLYGON (((97.14738 19...
6  5145.659 MULTIPOLYGON (((96.94981 22...
7  2796.608 MULTIPOLYGON (((97.8399 21....
8  3212.461 MULTIPOLYGON (((98.50485 20...
9  2441.520 MULTIPOLYGON (((97.64508 20...
10 5169.468 MULTIPOLYGON (((98.99319 20...</code></pre>
</div>
</div>
<p>Notice that sf.data.frame is conformed to Hardy Wickham’s <a href="https://edzer.github.io/rstudio_conf/#1">tidy</a> framework.</p>
<p>Since <em>shan_sf_ST</em> is conformed to tidy framework, we can also <em>glimpse()</em> to reveal the data type of it’s fields.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(shan_sf_ST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 31
Columns: 15
$ OBJECTID   &lt;dbl&gt; 203, 240, 106, 40, 194, 159, 155, 101, 105, 0, 56, 196, 41,…
$ ST         &lt;chr&gt; "Shan (South)", "Shan (South)", "Shan (South)", "Shan (Sout…
$ ST_PCODE   &lt;chr&gt; "MMR014", "MMR014", "MMR014", "MMR014", "MMR014", "MMR014",…
$ DT         &lt;chr&gt; "Taunggyi", "Taunggyi", "Taunggyi", "Taunggyi", "Taunggyi",…
$ DT_PCODE   &lt;chr&gt; "MMR014D001", "MMR014D001", "MMR014D001", "MMR014D001", "MM…
$ TS         &lt;chr&gt; "Pindaya", "Ywangan", "Pinlaung", "Kalaw", "Pekon", "Lawksa…
$ TS_PCODE   &lt;chr&gt; "MMR014006", "MMR014007", "MMR014009", "MMR014005", "MMR014…
$ ST_2       &lt;chr&gt; "Shan State (South)", "Shan State (South)", "Shan State (So…
$ LABEL2     &lt;chr&gt; "Pindaya\n77769", "Ywangan\n76933", "Pinlaung\n162537", "Ka…
$ SELF_ADMIN &lt;chr&gt; "Danu", "Danu", "Pa-O", NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ST_RG      &lt;chr&gt; "State", "State", "State", "State", "State", "State", "Stat…
$ T_NAME_WIN &lt;chr&gt; "yif;w,", "&amp;GmiH", "yifavmif;", "uavm", "z,fcHk", "&amp;yfapmuf…
$ T_NAME_M3  &lt;chr&gt; "ပင်းတယ", "ရွာငံ", "ပင်လောင်း", "ကလော", "ဖယ်ခုံ", "ရပ်စောက်", "လဲချား"…
$ AREA       &lt;dbl&gt; 629.025, 2984.377, 3396.963, 1456.624, 2073.513, 5145.659, …
$ geometry   &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((96.7731 21...., MULTIPOLYGON (…</code></pre>
</div>
</div>
</section>
<section id="importing-aspatial-data-into-r-environment." class="level3">
<h3 class="anchored" data-anchor-id="importing-aspatial-data-into-r-environment.">2.2 Importing aspatial data into R environment.</h3>
<p>We use read_csv function of readr package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ict <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/Shan-ICT.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 55 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): District Pcode, District Name, Township Pcode, Township Name
dbl (7): Total households, Radio, Television, Land line phone, Mobile phone,...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>The imported InfoComm variables are extracted from <strong>The 2014 Myanmar Population and Housing Census Myanmar</strong>. The attribute data set is called <em>ict</em>. It is saved in R’s * tibble data.frame* format.</p>
<p>The code chunk below reveal the summary statistics of <em>ict</em> data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> District Pcode     District Name      Township Pcode     Township Name     
 Length:55          Length:55          Length:55          Length:55         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 Total households     Radio         Television    Land line phone 
 Min.   : 3318    Min.   :  115   Min.   :  728   Min.   :  20.0  
 1st Qu.: 8711    1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  
 Median :13685    Median : 2497   Median : 6117   Median : 695.0  
 Mean   :18369    Mean   : 4487   Mean   :10183   Mean   : 929.9  
 3rd Qu.:23471    3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  
 Max.   :82604    Max.   :30176   Max.   :62388   Max.   :6736.0  
  Mobile phone      Computer      Internet at home
 Min.   :  150   Min.   :  20.0   Min.   :   8.0  
 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0  
 Median : 3559   Median : 244.0   Median : 316.0  
 Mean   : 6470   Mean   : 575.5   Mean   : 760.2  
 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5  
 Max.   :48461   Max.   :6705.0   Max.   :9746.0  </code></pre>
</div>
</div>
<p>2.3 Derive new variables using dplyr package.</p>
<p>The unit of measurement of the values are number of households. Using these values directly will be biased by the underlying total number of households.</p>
<p>In general, the townships with relatively higher total number of households will also have higher number of households owning radio, TV, etc.</p>
<p>In order to overcome this problem, we will derive the penetration rate of each ICT variable by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ict_derived <span class="ot">&lt;-</span> ict <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Radio</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">TV_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Television</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">LLPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">MPHONE_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">COMPUTER_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Computer</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">INTERNET_PR</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">DT_PCODE</span><span class="st">`</span> <span class="ot">=</span><span class="st">`</span><span class="at">District Pcode</span><span class="st">`</span>,<span class="st">`</span><span class="at">DT</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">District Name</span><span class="st">`</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TS_PCODE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Pcode</span><span class="st">`</span>, <span class="st">`</span><span class="at">TS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Township Name</span><span class="st">`</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">TT_HOUSEHOLDS</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Total households</span><span class="st">`</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">RADIO</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Radio</span><span class="st">`</span>, <span class="st">`</span><span class="at">TV</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Television</span><span class="st">`</span>, </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">LLPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Land line phone</span><span class="st">`</span>, <span class="st">`</span><span class="at">MPHONE</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Mobile phone</span><span class="st">`</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">COMPUTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Computer</span><span class="st">`</span>, <span class="st">`</span><span class="at">INTERNET</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">Internet at home</span><span class="st">`</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us review the summary statistics of the newly derived penetration rates using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ict_derived)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   DT_PCODE              DT              TS_PCODE              TS           
 Length:55          Length:55          Length:55          Length:55         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 TT_HOUSEHOLDS       RADIO             TV           LLPHONE      
 Min.   : 3318   Min.   :  115   Min.   :  728   Min.   :  20.0  
 1st Qu.: 8711   1st Qu.: 1260   1st Qu.: 3744   1st Qu.: 266.5  
 Median :13685   Median : 2497   Median : 6117   Median : 695.0  
 Mean   :18369   Mean   : 4487   Mean   :10183   Mean   : 929.9  
 3rd Qu.:23471   3rd Qu.: 6192   3rd Qu.:13906   3rd Qu.:1082.5  
 Max.   :82604   Max.   :30176   Max.   :62388   Max.   :6736.0  
     MPHONE         COMPUTER         INTERNET         RADIO_PR     
 Min.   :  150   Min.   :  20.0   Min.   :   8.0   Min.   : 21.05  
 1st Qu.: 2037   1st Qu.: 121.0   1st Qu.:  88.0   1st Qu.:138.95  
 Median : 3559   Median : 244.0   Median : 316.0   Median :210.95  
 Mean   : 6470   Mean   : 575.5   Mean   : 760.2   Mean   :215.68  
 3rd Qu.: 7177   3rd Qu.: 507.0   3rd Qu.: 630.5   3rd Qu.:268.07  
 Max.   :48461   Max.   :6705.0   Max.   :9746.0   Max.   :484.52  
     TV_PR         LLPHONE_PR       MPHONE_PR       COMPUTER_PR    
 Min.   :116.0   Min.   :  2.78   Min.   : 36.42   Min.   : 3.278  
 1st Qu.:450.2   1st Qu.: 22.84   1st Qu.:190.14   1st Qu.:11.832  
 Median :517.2   Median : 37.59   Median :305.27   Median :18.970  
 Mean   :509.5   Mean   : 51.09   Mean   :314.05   Mean   :24.393  
 3rd Qu.:606.4   3rd Qu.: 69.72   3rd Qu.:428.43   3rd Qu.:29.897  
 Max.   :842.5   Max.   :181.49   Max.   :735.43   Max.   :92.402  
  INTERNET_PR     
 Min.   :  1.041  
 1st Qu.:  8.617  
 Median : 22.829  
 Mean   : 30.644  
 3rd Qu.: 41.281  
 Max.   :117.985  </code></pre>
</div>
</div>
<p>Notice that six new fields have been added into the data.frame. They are RADIO_PR, TV_PR, LLPHONE_PR, MPHONE_PR, COMPUTER_PR, and INTERNET_PR.</p>
</section>
</section>
<section id="exploratory-data-analysis." class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis.">3. Exploratory Data Analysis.</h2>
<p>We can plot the distribution of the variables (i.e.&nbsp;Number of households with radio) by using appropriate Exploratory Data Analysis (EDA) as shown in the code chunk below.</p>
<p>Histogram is useful to identify the overall distribution of the data values (i.e.&nbsp;left skew, right skew or normal distribution)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ict_derived,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Boxplot are useful to detect if there are outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ict_derived,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">'black'</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill=</span><span class="st">'light blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let us now plot the distribution of newly created variables.( Radio Penetration Rate ) by using the code chunk below :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ict_derived,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>,<span class="at">alpha=</span><span class="fl">0.3</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">'black'</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="st">"light green"</span>)<span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">1.1</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ict_derived,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>,))<span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"turquoise2"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill=</span><span class="st">"wheat"</span>,<span class="at">notch =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let us plot multiple histograms and then arrange them together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>radio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ict_derived,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="st">'black'</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill=</span> <span class="st">'light blue'</span>)<span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Radio count histogram plot"</span>,<span class="at">x=</span><span class="st">"Radio_PR"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)<span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">theme_classic</span>()</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>tv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ict_derived,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">TV_PR</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>,<span class="at">binwidth =</span><span class="dv">35</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color=</span><span class="st">'grey'</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> <span class="st">'light green'</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"TV count histogram plot"</span>,<span class="at">x=</span><span class="st">"TV_PR"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)<span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme_classic</span>()</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>llphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ict_derived,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">LLPHONE_PR</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">show.legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color=</span><span class="st">'black'</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fill=</span><span class="st">'yellow'</span>,<span class="at">alpha=</span><span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Land Line Phone count histogram plot"</span>,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x=</span><span class="st">"LLPHONE_PR"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)<span class="sc">+</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">theme_classic</span>()</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>mphone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ict_derived,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">MPHONE_PR</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>,</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>                         <span class="at">color=</span><span class="st">'grey'</span>,</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill=</span><span class="st">'light blue'</span>)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>computer <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ict_derived,</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">COMPUTER_PR</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>,<span class="at">alpha=</span><span class="fl">0.3</span>,</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color=</span><span class="st">'grey'</span>,</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill=</span><span class="st">'magenta'</span>)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>internet <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ict_derived,</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">INTERNET_PR</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>,</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha=</span><span class="fl">0.3</span>,</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>                           <span class="at">color=</span><span class="st">'blue'</span>,</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill=</span><span class="st">'yellow'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, ggarange() function of ggpubr package is used to group the histograms together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(radio,tv,llphone,mphone,computer,internet,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="eda-using-choropleth-map." class="level2">
<h2 class="anchored" data-anchor-id="eda-using-choropleth-map.">4. EDA using Choropleth map.</h2>
<section id="joining-aspatial-data-with-geospatial-data." class="level3">
<h3 class="anchored" data-anchor-id="joining-aspatial-data-with-geospatial-data.">4.1 Joining aspatial data with geospatial data.</h3>
<p>Before we can prepare Choropleth map,we need to combine both aspatial data frame (<strong><em>ict_derived</em></strong>)</p>
<p>and geospatial data(<strong><em>shan_sf_ST</em></strong>).</p>
<p>This will be performed by left_join function of dplyr package. The <strong><em>shan_sf_ST</em></strong> simple feature data frame will be used as the base data object and the <strong><em>ict_derived</em></strong> data frame will be used as the join table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>shan_sf_ST <span class="ot">&lt;-</span> <span class="fu">left_join</span>(shan_sf_ST, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                     ict_derived, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"TS_PCODE"</span><span class="ot">=</span><span class="st">"TS_PCODE"</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(shan_sf_ST, <span class="st">"data/rds/shan_sf_ST.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code chunks below is used to perform the task. The unique identifier used to join both data objects is <em>TS_PCODE</em>. It is important to note that there is no new output data been created. Instead, the data fields from <em>ict_derived</em> data frame are now updated into the data frame of <em>shan_sf</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>shan_sf_final <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/shan_sf_ST.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-choropleth-map." class="level3">
<h3 class="anchored" data-anchor-id="preparing-choropleth-map.">4.2 Preparing Choropleth Map.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_final, <span class="st">"RADIO_PR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We will create two choropleth maps, one for the total number of households (i.e.&nbsp;TT_HOUSEHOLDS.map) and one for the total number of household with Radio (RADIO.map) by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>TT_HOUSEHOLDS.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf_final) <span class="sc">+</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"TT_HOUSEHOLDS"</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>, </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Total households"</span>) <span class="sc">+</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>RADIO.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(shan_sf_final) <span class="sc">+</span> </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"RADIO"</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"jenks"</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Number Radio "</span>) <span class="sc">+</span> </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(TT_HOUSEHOLDS.map, RADIO.map,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice that the choropleth maps above clearly show that townships with relatively larger number ot households are also showing relatively higher number of radio ownership.</p>
<p>Now let us plot the choropleth maps showing the distribution of total number of households and Radio penetration rate by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(shan_sf_final) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_polygons</span>(<span class="fu">c</span>(<span class="st">"TT_HOUSEHOLDS"</span>, <span class="st">"RADIO_PR"</span>),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">style=</span><span class="st">"jenks"</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_facets</span>(<span class="at">sync =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))<span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">outer.margins=</span><span class="dv">0</span>, <span class="at">asp=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="correlation-analysis." class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis.">5. Correlation Analysis.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>cluster_vars.cor <span class="ot">=</span> <span class="fu">cor</span>(ict_derived[,<span class="dv">12</span><span class="sc">:</span><span class="dv">17</span>])</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(cluster_vars.cor,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="st">"number"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.pos =</span> <span class="st">"lt"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">"l"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The correlation plot above shows that COMPUTER_PR and INTERNET_PR are highly correlated. This suggest that only one of them should be used in the cluster analysis instead of both.</p>
</section>
<section id="hierarchy-cluster-analysis." class="level2">
<h2 class="anchored" data-anchor-id="hierarchy-cluster-analysis.">6. Hierarchy Cluster Analysis.</h2>
<p>Let us perform hierarchical cluster analysis using 4 steps.</p>
<section id="extracting-clustering-variables." class="level3">
<h3 class="anchored" data-anchor-id="extracting-clustering-variables.">6.1 Extracting clustering variables.</h3>
<p>The code chunk below will be used to extract the clustering variables from the <strong><em>shan_sf</em>_final</strong> simple feature object into data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>cluster_vars <span class="ot">&lt;-</span> shan_sf_final <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"TS.x"</span>, <span class="st">"RADIO_PR"</span>, <span class="st">"TV_PR"</span>, <span class="st">"LLPHONE_PR"</span>, <span class="st">"MPHONE_PR"</span>, <span class="st">"COMPUTER_PR"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       TS.x  RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
1   Pindaya 417.46466 505.1300  19.835841 162.39170   12.881897
2   Ywangan 484.52147 260.5734  11.935906 120.28559    4.414650
3  Pinlaung 231.64994 541.7189  28.544542 249.49028   13.762547
4     Kalaw 280.76244 611.6204  42.064778 408.79514   29.631601
5     Pekon 318.61183 535.8494  39.832703 214.84764   18.970325
6  Lawksawk 387.10175 630.0035  31.513657 320.56863   21.766768
7    Laihka 153.35609 590.5575  65.529010 261.43345   27.758817
8   Mongnai 182.51928 515.9062   5.141388 267.51285   28.277635
9   Mawkmai  97.44231 234.5010   2.780095  36.41924    7.784265
10  Mongton 193.51808 388.4453  25.129169 290.51198   21.841240</code></pre>
</div>
</div>
</section>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<p>Notice that the final clustering variables list does not include variable INTERNET_PR because it is highly correlated with variable COMPUTER_PR.</p>
<p>Next, we need to change the rows by township name instead of row number by using the code chunk below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(cluster_vars) <span class="ot">&lt;-</span> cluster_vars<span class="sc">$</span><span class="st">"TS.x"</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             TS.x  RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
Pindaya   Pindaya 417.46466 505.1300  19.835841 162.39170   12.881897
Ywangan   Ywangan 484.52147 260.5734  11.935906 120.28559    4.414650
Pinlaung Pinlaung 231.64994 541.7189  28.544542 249.49028   13.762547
Kalaw       Kalaw 280.76244 611.6204  42.064778 408.79514   29.631601
Pekon       Pekon 318.61183 535.8494  39.832703 214.84764   18.970325
Lawksawk Lawksawk 387.10175 630.0035  31.513657 320.56863   21.766768
Laihka     Laihka 153.35609 590.5575  65.529010 261.43345   27.758817
Mongnai   Mongnai 182.51928 515.9062   5.141388 267.51285   28.277635
Mawkmai   Mawkmai  97.44231 234.5010   2.780095  36.41924    7.784265
Mongton   Mongton 193.51808 388.4453  25.129169 290.51198   21.841240</code></pre>
</div>
</div>
<p>The row number has been replaced into the township name.</p>
<p>Now, we will delete the TS.x field by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>shan_ict <span class="ot">&lt;-</span> <span class="fu">select</span>(cluster_vars, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shan_ict, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          RADIO_PR    TV_PR LLPHONE_PR MPHONE_PR COMPUTER_PR
Pindaya  417.46466 505.1300  19.835841 162.39170   12.881897
Ywangan  484.52147 260.5734  11.935906 120.28559    4.414650
Pinlaung 231.64994 541.7189  28.544542 249.49028   13.762547
Kalaw    280.76244 611.6204  42.064778 408.79514   29.631601
Pekon    318.61183 535.8494  39.832703 214.84764   18.970325
Lawksawk 387.10175 630.0035  31.513657 320.56863   21.766768
Laihka   153.35609 590.5575  65.529010 261.43345   27.758817
Mongnai  182.51928 515.9062   5.141388 267.51285   28.277635
Mawkmai   97.44231 234.5010   2.780095  36.41924    7.784265
Mongton  193.51808 388.4453  25.129169 290.51198   21.841240</code></pre>
</div>
</div>
<section id="data-standardization." class="level3">
<h3 class="anchored" data-anchor-id="data-standardization.">6.2 Data Standardization.</h3>
<p>In general, multiple variables will be used in cluster analysis. It is not unusual their values range are different. In order to avoid the cluster analysis result is biased to clustering variables with large values, it is useful to standardize the input variables before performing cluster analysis.</p>
<section id="min-max-standardization." class="level4">
<h4 class="anchored" data-anchor-id="min-max-standardization.">6.2.1 Min-Max standardization.</h4>
<p>In the code chunk below, <em>normalize()</em> of <a href="https://cran.r-project.org/web/packages/heatmaply/"><em>heatmaply</em></a> package is used to stadardisation the clustering variables by using Min-Max method. The <em>summary()</em> is then used to display the summary statistics of the standardised clustering variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>shan_ict.std <span class="ot">&lt;-</span> <span class="fu">normalize</span>(shan_ict)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan_ict.std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    RADIO_PR          TV_PR          LLPHONE_PR       MPHONE_PR     
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.2117   1st Qu.:0.5315   1st Qu.:0.1580   1st Qu.:0.2199  
 Median :0.3803   Median :0.6236   Median :0.2434   Median :0.3306  
 Mean   :0.3991   Mean   :0.6126   Mean   :0.3236   Mean   :0.3722  
 3rd Qu.:0.5522   3rd Qu.:0.7349   3rd Qu.:0.4924   3rd Qu.:0.5099  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
  COMPUTER_PR     
 Min.   :0.00000  
 1st Qu.:0.09561  
 Median :0.19721  
 Mean   :0.24552  
 3rd Qu.:0.29234  
 Max.   :1.00000  </code></pre>
</div>
</div>
<p>Notice that the values range of the Min-max standardized clustering variables are 0-1 now.</p>
</section>
<section id="z-score-standardization." class="level4">
<h4 class="anchored" data-anchor-id="z-score-standardization.">6.2.2 Z-score standardization.</h4>
<p>Z-score standardization can be performed easily by using <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/scale"><em>scale()</em></a> of Base R. The code chunk below will be used to standardization the clustering variables by using Z-score method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>shan_ict.z <span class="ot">&lt;-</span> <span class="fu">scale</span>(shan_ict)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(shan_ict.z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            vars  n mean sd median trimmed  mad   min  max range  skew kurtosis
RADIO_PR       1 31    0  1  -0.07   -0.04 0.99 -1.53 2.30  3.82  0.39    -0.72
TV_PR          2 31    0  1   0.05    0.05 0.70 -2.65 1.68  4.33 -0.60     0.20
LLPHONE_PR     3 31    0  1  -0.31   -0.12 0.58 -1.26 2.64  3.90  1.02     0.25
MPHONE_PR      4 31    0  1  -0.18   -0.07 0.96 -1.60 2.70  4.30  0.62     0.01
COMPUTER_PR    5 31    0  1  -0.20   -0.19 0.63 -1.04 3.18  4.22  1.70     2.42
              se
RADIO_PR    0.18
TV_PR       0.18
LLPHONE_PR  0.18
MPHONE_PR   0.18
COMPUTER_PR 0.18</code></pre>
</div>
</div>
<p>Notice the mean and standard deviation of the Z-score standardised clustering variables are 0 and 1 respectively.</p>
<p><strong>Note:</strong> <a href="https://www.rdocumentation.org/packages/Hmisc/versions/4.4-0/topics/describe"><em>describe()</em></a> of <a href="https://cran.r-project.org/web/packages/psych/"><strong>psych</strong></a> package is used here instead of <em>summary()</em> of Base R because the earlier provides standard deviation.</p>
<p>Warning: Z-score standardization method should only be used if we would assume all variables come from some normal distribution.</p>
</section>
</section>
<section id="visualizing-the-standardized-clustering-variables." class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-standardized-clustering-variables.">6.3 Visualizing the standardized clustering variables.</h3>
<p>Beside reviewing the summary statistics of the standardised clustering variables, it is also a good practice to visualize their distribution graphically</p>
<p>The code chunk below plots the scaled <em>Radio_PR</em> field.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values without standardisation"</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>shan_ict_s_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.std)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_s_df, </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max Standardisation"</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>shan_ict_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.z)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_z_df, </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score Standardisation"</span>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>ict_derived, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values without standardisation"</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>shan_ict_s_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.std)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_s_df, </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max Standardisation"</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>shan_ict_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(shan_ict.z)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shan_ict_z_df, </span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">RADIO_PR</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score Standardisation"</span>)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1"></h3>
<p>6.4 Computing proximity matrix.</p>
<p>Here, we will compute the proximity matrix by using <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/dist.html"><em>dist()</em></a> of R.</p>
<p><em>dist()</em> supports six distance proximity calculations, they are:</p>
<ol type="1">
<li><p><strong>euclidean,</strong></p></li>
<li><p><strong>maximum,</strong></p></li>
<li><p><strong>manhattan,</strong></p></li>
<li><p><strong>canberra,</strong></p></li>
<li><p><strong>binary and</strong></p></li>
<li><p><strong>minkowski</strong>.</p>
<p>The default is <em>euclidean</em> proximity matrix. The code chunk below is used to compute the proximity matrix using <em>euclidean</em> method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>proxmat <span class="ot">&lt;-</span> <span class="fu">dist</span>(shan_ict, <span class="at">method =</span> <span class="st">'euclidean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
<p>The code chunk below can then be used to list the content of <em>proxmat</em> for visual inspection.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>proxmat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Pindaya   Ywangan  Pinlaung     Kalaw     Pekon  Lawksawk
Ywangan    257.31610                                                  
Pinlaung   208.63519 400.05492                                        
Kalaw      302.51785 499.53297 181.96406                              
Pekon      117.91580 336.50410  94.61225 211.91531                    
Lawksawk   204.32952 432.16535 192.57320 140.01101 157.51129          
Laihka     298.61288 491.83321 101.10150 197.34633 182.23667 246.74469
Mongnai    258.49346 422.71934  64.52387 200.34668 151.60031 241.71260
Mawkmai    437.99577 397.03752 398.11227 562.59200 416.00669 567.52693
Mongton    283.35574 361.23257 163.42143 267.87522 208.14888 311.07742
Mongkaing  481.71125 364.98429 476.29056 625.24500 480.23965 625.18712
Mongpan    335.72896 483.68125 192.78316 114.69105 243.30037 228.54223
Tachileik  635.51774 807.44220 555.01039 373.64459 573.39528 441.82621
Mongkhet   391.74783 408.97731 305.86058 465.52013 342.08722 487.41102
Monghsat   314.71506 432.98028 160.44703 317.96188 225.64279 352.31496
Nansang    275.44246 472.77637  85.49572 124.30500 160.37607 188.78869
Monghpyak  221.30579 367.44835 222.20020 167.08436 190.93173 142.31691
Mongping   310.64850 337.94020 229.75261 375.64739 259.68288 396.47081
Hopong     223.06050 352.85844  98.14855 264.16294 138.86577 274.91604
Nyaungshwe 216.52463 407.11649 138.12050  95.66782 139.31874 104.17830
Hsihseng   172.00796 342.91035 111.61846 287.11074 105.30573 257.11202
Mongla     549.42389 728.16301 372.59678 260.26411 441.20998 393.18472
Kengtung   385.68322 573.23173 263.48638  88.29335 297.67761 209.38215
Langkho    323.28133 507.78892 168.44228  67.19580 219.21623 190.30257
Monghsu    198.35391 340.42789  80.86834 237.34578 113.84636 242.04063
Taunggyi   503.75471 697.98323 429.54386 252.26066 440.66133 304.96838
Kyethi     175.54012 287.29358 189.47065 360.17247 162.43575 317.74604
Loilen     293.61143 469.51621  91.56527 217.19877 181.94596 265.29318
Mongyang   475.93982 630.71590 286.03834 233.56349 363.58788 363.37684
Kunhing    318.23811 449.67218 141.58836 197.63683 213.46379 278.68953
Mongyawng  332.92193 570.56521 235.55497 173.43078 248.43910 179.07229
              Laihka   Mongnai   Mawkmai   Mongton Mongkaing   Mongpan
Ywangan                                                               
Pinlaung                                                              
Kalaw                                                                 
Pekon                                                                 
Lawksawk                                                              
Laihka                                                                
Mongnai    100.53457                                                  
Mawkmai    429.96554 374.50873                                        
Mongton    212.07320 131.67061 313.35220                              
Mongkaing  522.96309 456.00842 133.29995 365.50032                    
Mongpan    210.76951 178.09554 509.99632 200.31803 563.56780          
Tachileik  549.08985 563.95232 919.38755 608.76740 967.14087 411.03849
Mongkhet   324.97428 275.76855 115.58388 223.22828 222.60577 412.17123
Monghsat   158.93517 125.25968 275.09705 150.98053 375.60376 283.30992
Nansang     78.78999  92.79567 462.41938 199.58124 542.16609 144.77393
Monghpyak  293.22640 253.26470 536.71695 258.04282 568.21089 187.85699
Mongping   272.82761 202.99615 194.31049 119.86993 257.18572 318.47482
Hopong     157.48857  91.53795 302.84362 106.21031 379.37916 239.43845
Nyaungshwe 201.71653 169.63695 502.99026 219.72196 557.32112 137.29734
Hsihseng   175.89761 142.36728 329.29477 194.64317 411.59788 295.87811
Mongla     315.93218 354.10985 686.88950 411.06668 761.48327 253.20001
Kengtung   258.23950 272.28711 632.54638 329.38387 692.74693 142.21554
Langkho    160.94435 174.67678 531.08019 236.70878 597.42714  94.98486
Monghsu    163.28926  84.11238 332.07962 107.04894 400.71816 216.25326
Taunggyi   425.36916 448.55282 810.74692 508.40925 866.21117 319.81385
Kyethi     255.83275 210.50453 278.85535 222.52947 352.06533 358.89620
Loilen      59.69478  58.41263 388.73386 176.16001 482.18190 207.25000
Mongyang   229.71502 260.39387 558.83162 295.60023 631.91325 194.93467
Kunhing    142.03682 110.55197 398.43973 114.03609 465.03971 137.85278
Mongyawng  211.99976 275.77546 620.04321 375.22688 700.98284 275.15989
           Tachileik  Mongkhet  Monghsat   Nansang Monghpyak  Mongping
Ywangan                                                               
Pinlaung                                                              
Kalaw                                                                 
Pekon                                                                 
Lawksawk                                                              
Laihka                                                                
Mongnai                                                               
Mawkmai                                                               
Mongton                                                               
Mongkaing                                                             
Mongpan                                                               
Tachileik                                                             
Mongkhet   820.50164                                                  
Monghsat   677.09508 167.98445                                        
Nansang    486.77266 360.99219 201.92690                              
Monghpyak  444.04411 462.63265 356.84917 227.52638                    
Mongping   727.08969 113.80917 140.95392 287.36626 354.76537          
Hopong     632.45718 212.99485 100.45714 167.66291 267.95563 134.00139
Nyaungshwe 445.81335 417.08639 286.37238 131.18943 103.97300 319.32583
Hsihseng   658.87060 256.70338 153.49551 193.53779 285.37627 199.64389
Mongla     347.33155 574.40292 429.00536 289.45119 408.03397 512.61580
Kengtung   295.90429 531.35998 383.72138 193.67980 221.47613 442.80821
Langkho    402.33622 428.08061 279.52329  99.39859 200.27496 343.96455
Monghsu    605.02113 247.73318 137.24737 153.59962 232.17823 158.90478
Taunggyi   150.84117 712.80752 562.88102 365.04897 334.17439 621.53039
Kyethi     728.87329 233.25039 190.50609 273.02385 328.16234 187.43974
Loilen     573.75476 284.76895 118.65144  94.23028 296.99681 231.99959
Mongyang   448.79027 445.40621 312.64797 218.49285 358.17599 387.80686
Kunhing    532.26397 292.49814 165.38834 128.20940 250.74435 212.59619
Mongyawng  432.10118 522.91815 364.40429 191.11990 285.56475 455.59190
              Hopong Nyaungshwe  Hsihseng    Mongla  Kengtung   Langkho
Ywangan                                                                
Pinlaung                                                               
Kalaw                                                                  
Pekon                                                                  
Lawksawk                                                               
Laihka                                                                 
Mongnai                                                                
Mawkmai                                                                
Mongton                                                                
Mongkaing                                                              
Mongpan                                                                
Tachileik                                                              
Mongkhet                                                               
Monghsat                                                               
Nansang                                                                
Monghpyak                                                              
Mongping                                                               
Hopong                                                                 
Nyaungshwe 209.32532                                                   
Hsihseng    91.65458  225.80242                                        
Mongla     432.31105  347.60273 478.66210                              
Kengtung   340.47382  177.75714 370.72441 202.45004                    
Langkho    239.63685  128.26577 276.27441 229.01675 107.16213          
Monghsu     43.40665  173.82799  97.82470 424.51868 316.91914 221.84918
Taunggyi   513.76415  325.09619 528.14240 297.09863 186.28225 288.27478
Kyethi     136.49038  288.06872  84.04049 556.02500 444.26274 350.91512
Loilen     124.74445  206.40432 158.84853 338.67408 282.22935 184.10672
Mongyang   323.35704  294.29500 382.59743 146.66661 217.08047 175.35413
Kunhing    145.15617  189.97131 220.15490 306.47566 245.95083 146.38284
Mongyawng  326.59925  218.12104 309.51462 315.57550 203.87199 186.11584
             Monghsu  Taunggyi    Kyethi    Loilen  Mongyang   Kunhing
Ywangan                                                               
Pinlaung                                                              
Kalaw                                                                 
Pekon                                                                 
Lawksawk                                                              
Laihka                                                                
Mongnai                                                               
Mawkmai                                                               
Mongton                                                               
Mongkaing                                                             
Mongpan                                                               
Tachileik                                                             
Mongkhet                                                              
Monghsat                                                              
Nansang                                                               
Monghpyak                                                             
Mongping                                                              
Hopong                                                                
Nyaungshwe                                                            
Hsihseng                                                              
Mongla                                                                
Kengtung                                                              
Langkho                                                               
Monghsu                                                               
Taunggyi   486.91951                                                  
Kyethi     146.61572 599.57407                                        
Loilen     131.55208 455.91617 232.32965                              
Mongyang   323.95988 374.58247 453.86726 246.76592                    
Kunhing    146.78891 429.98509 278.95182 130.39336 188.89405          
Mongyawng  312.85089 287.73864 387.71518 261.75211 304.21734 295.35984</code></pre>
</div>
</div>
</section>
<section id="computing-hierarchical-clustering." class="level3">
<h3 class="anchored" data-anchor-id="computing-hierarchical-clustering.">6.5 Computing hierarchical clustering.</h3>
<p>In R, there are several packages provide hierarchical clustering function. In this hands-on exercise, <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/hclust.html"><em>hclust()</em></a> of R stats will be used.</p>
<p><em>hclust()</em> employed agglomeration method to compute the cluster. Eight clustering algorithms are supported, they are: ward.D, ward.D2, single, complete, average(UPGMA), mcquitty(WPGMA), median(WPGMC) and centroid(UPGMC).</p>
<p>The code chunk below performs hierarchical cluster analysis using ward.D method. The hierarchical clustering output is stored in an object of class <strong>hclust</strong> which describes the tree produced by the clustering process.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>hclust_ward <span class="ot">&lt;-</span> <span class="fu">hclust</span>(proxmat, <span class="at">method =</span> <span class="st">'ward.D'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then plot the tree by using <em>plot()</em> of R Graphics as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2"></h3>
<p>6.6 Selecting the optimal clustering algorithm.</p>
<p>One of the challenge in performing hierarchical clustering is to identify stronger clustering structures. The issue can be solved by using use <a href="https://www.rdocumentation.org/packages/cluster/versions/2.1.0/topics/agnes"><em>agnes()</em></a> function of <a href="https://cran.r-project.org/web/packages/cluster/"><strong>cluster</strong></a> package. It functions like <em>hclus()</em>, however, with the <em>agnes()</em> function you can also get the agglomerative coefficient, which measures the amount of clustering structure found (values closer to 1 suggest strong clustering structure).</p>
<p>The code chunk below will be used to compute the agglomerative coefficients of all hierarchical clustering algorithms.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>ac <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">agnes</span>(shan_ict, <span class="at">method =</span> x)<span class="sc">$</span>ac</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(m, ac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  average    single  complete      ward 
0.7774059 0.5952977 0.8793162 0.9072821 </code></pre>
</div>
</div>
<p>With reference to the output above, we can see that Ward’s method provides the strongest clustering structure among the four methods assessed. Hence, in the subsequent analysis, only Ward’s method will be used.</p>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3"></h3>
<p>6.7 Determining Optimal Clusters.</p>
<p>Another technical challenge face by data analyst in performing clustering analysis is to determine the optimal clusters to retain.</p>
<p>There are <a href="https://statweb.stanford.edu/~gwalther/gap">three</a> commonly used methods to determine the optimal clusters, they are:</p>
<ul>
<li><p><a href="https://en.wikipedia.org/wiki/Elbow_method_(clustering)">Elbow Method</a></p></li>
<li><p><a href="https://www.sciencedirect.com/science/article/pii/0377042787901257?via%3Dihub">Average Silhouette Method</a></p></li>
<li><p><a href="http://www.web.stanford.edu/~hastie/Papers/gap.pdf">Gap Statistic Method</a></p></li>
</ul>
<section id="gap-statistic-method." class="level4">
<h4 class="anchored" data-anchor-id="gap-statistic-method.">6.7.1 Gap Statistic Method.</h4>
<p>The <a href="http://www.web.stanford.edu/~hastie/Papers/gap.pdf"><strong>gap statistic</strong></a> compares the total within intra-cluster variation for different values of <strong>k</strong> with their expected values under null reference distribution of the data. The estimate of the optimal clusters will be value that maximize the gap statistic (i.e., that yields the largest gap statistic). This means that the clustering structure is far away from the random uniform distribution of points.</p>
<p>To compute the gap statistic, <a href="https://www.rdocumentation.org/packages/cluster/versions/2.1.0/topics/clusGap"><em>clusGap()</em></a> of <a href="https://cran.r-project.org/web/packages/cluster/"><strong>cluster</strong></a> package will be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>gap_stat <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(shan_ict, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN =</span> hcut, </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nstart =</span> <span class="dv">25</span>, </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K.max =</span> <span class="dv">10</span>, </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">B =</span> <span class="dv">50</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gap_stat, <span class="at">method =</span> <span class="st">"firstmax"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Clustering Gap statistic ["clusGap"] from call:
clusGap(x = shan_ict, FUNcluster = hcut, K.max = 10, B = 50, nstart = 25)
B=50 simulated reference sets, k = 1..10; spaceH0="scaledPCA"
 --&gt; Number of clusters (method 'firstmax'): 1
          logW   E.logW       gap     SE.sim
 [1,] 7.752011 8.014360 0.2623494 0.06942530
 [2,] 7.469068 7.629201 0.1601327 0.04744104
 [3,] 7.297084 7.429967 0.1328833 0.04869766
 [4,] 7.164278 7.275153 0.1108751 0.05254734
 [5,] 7.016330 7.134565 0.1182350 0.05934723
 [6,] 6.881035 7.015049 0.1340141 0.06046231
 [7,] 6.770402 6.906309 0.1359065 0.05777411
 [8,] 6.671709 6.800596 0.1288872 0.05650743
 [9,] 6.581917 6.701054 0.1191367 0.05786612
[10,] 6.482232 6.601087 0.1188547 0.06049651</code></pre>
</div>
</div>
<p>Also note that the <a href="https://rpkgs.datanovia.com/factoextra/reference/hcut.html"><em>hcut</em></a> function used is from <a href="https://rpkgs.datanovia.com/factoextra/"><strong>factoextra</strong></a> package.</p>
<p>Next, we can visualise the plot by using <a href="https://rpkgs.datanovia.com/factoextra/reference/fviz_nbclust.html"><em>fviz_gap_stat()</em></a> of <a href="https://rpkgs.datanovia.com/factoextra/"><strong>factoextra</strong></a> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_gap_stat</span>(gap_stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>With reference to the gap statistic graph above, the recommended number of cluster to retain is 1. However, it is not logical to retain only one cluster. By examine the gap statistic graph, the 6-cluster gives the largest gap statistic and should be the next best cluster to pick.</p>
<p><strong>Note:</strong> In addition to these commonly used approaches, the <a href="https://cran.r-project.org/web/packages/NbClust/">NbClust</a> package, published by Charrad et al., 2014, provides 30 indices for determining the relevant number of clusters and proposes to users the best clustering scheme from the different results obtained by varying all combinations of number of clusters, distance measures, and clustering methods.</p>
</section>
</section>
<section id="interpreting-the-dendrograms." class="level3">
<h3 class="anchored" data-anchor-id="interpreting-the-dendrograms.">6.7.2 Interpreting the dendrograms.</h3>
<p>In the dendrogram displayed above, each leaf corresponds to one observation. As we move up the tree, observations that are similar to each other are combined into branches, which are themselves fused at a higher height.</p>
<p>The height of the fusion, provided on the vertical axis, indicates the (dis)similarity between two observations. The higher the height of the fusion, the less similar the observations are. Note that, conclusions about the proximity of two observations can be drawn only based on the height where branches containing those two observations first are fused. We cannot use the proximity of two observations along the horizontal axis as a criteria of their similarity.</p>
<p>It’s also possible to draw the dendrogram with a border around the selected clusters by using <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/rect.hclust.html"><em>rect.hclust()</em></a> of R stats. The argument <em>border</em> is used to specify the border colors for the rectangles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_ward, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">k =</span> <span class="dv">6</span>, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="visually-driven-hierarchical-clustering-analysis." class="level3">
<h3 class="anchored" data-anchor-id="visually-driven-hierarchical-clustering-analysis.">6.7.3 Visually-driven hierarchical clustering analysis.</h3>
<p>In this section, we will learn how to perform visually-driven hiearchical clustering analysis by using <a href="https://cran.r-project.org/web/packages/heatmaply/"><em>heatmaply</em></a> package.</p>
<p>With <strong>heatmaply</strong>, we are able to build both highly interactive cluster heatmap or static cluster heatmap.</p>
<p>The data was loaded into a data frame, but it has to be a data matrix to make your heatmap.</p>
<p>The code chunk below will be used to transform <em>shan_ict</em> data frame into a data matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>shan_ict_mat <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(shan_ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plotting-interactive-cluster-heatmap-using-heatmaply" class="level4">
<h4 class="anchored" data-anchor-id="plotting-interactive-cluster-heatmap-using-heatmaply">6.7.4 Plotting interactive cluster heatmap using <em>heatmaply()</em></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(<span class="fu">normalize</span>(shan_ict_mat),</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv=</span><span class="cn">NA</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist_method =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclust_method =</span> <span class="st">"ward.D"</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">seriate =</span> <span class="st">"OLO"</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> Blues,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_row =</span> <span class="dv">6</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">200</span>,<span class="dv">60</span>,<span class="cn">NA</span>),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">4</span>,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_col =</span> <span class="dv">5</span>,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">"Geographic Segmentation of Shan State by ICT indicators"</span>,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"ICT Indicators"</span>,</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Townships of Shan State"</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-9eceb20dc2a931752ae4" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9eceb20dc2a931752ae4">{"x":{"data":[{"x":[1,2,3,4,5],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],"z":[[0.205926273043225,0,0.0270171695974707,0.0205146898168363,0.0451632264769985],[0.0622520192843868,0.184135302312723,0,0,0.0382966071330552],[0.0184863966262553,0.306758405782862,0.220256641261337,0.111904436916593,0.0277191459892687],[0.21842041426644,0.333936290902205,0.183148370737635,0.220797228887767,0.0816442104969222],[0.295007664629742,0.423405327411151,0.187495219279928,0.363502861923713,0.198058043319845],[0.0870417513913425,0.534801938410225,0.266184392282222,0.219017992119371,0.209150932473573],[0.172433902024635,0.678560340092081,0.158301980227552,0.309844721395711,0.313690332327921],[0.268361679188983,0.621513143805108,0.0198098260803945,0.330600515260223,0.271209462741391],[0.397810654522423,0.542312990188334,0.0742383992580385,0.278454014117194,0.0906415890041446],[0.387386879011389,0.661633001405188,0.216148137218945,0.304817572789695,0.106241449885522],[0.324172132473446,0.528153761284321,0.247751053653138,0.248272216763125,0.114367263730804],[0.424024550834647,0.605446377144929,0.243429304420374,0.155474604691974,0.0625392033019739],[0.476955150368385,0.514633590303767,0.164238723886514,0.076155538926932,0.0953876394162065],[1,0.224658662397689,0.076811721112137,0.119978472699803,0],[0.837546430318847,0.604764072237741,0.143087403531642,0.180215108968874,0.0962326163868215],[0.598063009080602,0.652510230228414,0.310848979879756,0.255258118966462,0.165429291180986],[0.61041100396026,0.681477967617962,0.136066148522307,0.450320578796944,0.128166826505254],[0.763988447341294,0.798850415272024,0.241057218342425,0.406501651460893,0.197211649428868],[0.807417990884759,0.601959036958743,0.333208981858478,0.49414581896158,0.235571306216099],[0.506368095822015,0.770278323004509,0.329574745123248,0.532717729177229,0.286597658847325],[0.320394747741001,0.729986281010948,0.292007299760749,0.398016081357507,0.29808110156292],[0.380337395344116,0.623598298101459,0.157742775419191,0.574129014267529,0.478151327305384],[0.474260904706476,0.810948735134979,0.50691915233683,0.645068858125427,0.490156987615784],[0.377255152198863,0.732242201652944,0.60078049382024,0.525729584351687,0.3170163548885],[0.217410671284228,0.554958287541126,0.589818495477126,0.434988683676573,0.245771155383647],[0.197710172154653,0.737540910773905,0.526425464373066,0.321903369400093,0.265312950401877],[0.0252801967260761,0.865981571814495,0.706399443708488,0.742030952777324,0.661247300170049],[0,0.704540134897682,0.932598506894785,0.618872994218249,0.0958373585557404],[0.499881675740936,0.968718739178673,1,0.411501854757207,0.124013663042729],[0.711193230088641,0.993541542809373,0.660795705807666,0.787178952652566,0.872350492885991],[0.706455429707143,1,0.477957794194216,1,1]],"text":[["row: Mongkaing<br>column: RADIO_PR<br>value: 0.20593","row: Mongkaing<br>column: TV_PR<br>value: 0.00000","row: Mongkaing<br>column: LLPHONE_PR<br>value: 0.02702","row: Mongkaing<br>column: MPHONE_PR<br>value: 0.02051","row: Mongkaing<br>column: COMPUTER_PR<br>value: 0.04516"],["row: Mawkmai<br>column: RADIO_PR<br>value: 0.06225","row: Mawkmai<br>column: TV_PR<br>value: 0.18414","row: Mawkmai<br>column: LLPHONE_PR<br>value: 0.00000","row: Mawkmai<br>column: MPHONE_PR<br>value: 0.00000","row: Mawkmai<br>column: COMPUTER_PR<br>value: 0.03830"],["row: Mongkhet<br>column: RADIO_PR<br>value: 0.01849","row: Mongkhet<br>column: TV_PR<br>value: 0.30676","row: Mongkhet<br>column: LLPHONE_PR<br>value: 0.22026","row: Mongkhet<br>column: MPHONE_PR<br>value: 0.11190","row: Mongkhet<br>column: COMPUTER_PR<br>value: 0.02772"],["row: Mongping<br>column: RADIO_PR<br>value: 0.21842","row: Mongping<br>column: TV_PR<br>value: 0.33394","row: Mongping<br>column: LLPHONE_PR<br>value: 0.18315","row: Mongping<br>column: MPHONE_PR<br>value: 0.22080","row: Mongping<br>column: COMPUTER_PR<br>value: 0.08164"],["row: Mongton<br>column: RADIO_PR<br>value: 0.29501","row: Mongton<br>column: TV_PR<br>value: 0.42341","row: Mongton<br>column: LLPHONE_PR<br>value: 0.18750","row: Mongton<br>column: MPHONE_PR<br>value: 0.36350","row: Mongton<br>column: COMPUTER_PR<br>value: 0.19806"],["row: Monghsat<br>column: RADIO_PR<br>value: 0.08704","row: Monghsat<br>column: TV_PR<br>value: 0.53480","row: Monghsat<br>column: LLPHONE_PR<br>value: 0.26618","row: Monghsat<br>column: MPHONE_PR<br>value: 0.21902","row: Monghsat<br>column: COMPUTER_PR<br>value: 0.20915"],["row: Loilen<br>column: RADIO_PR<br>value: 0.17243","row: Loilen<br>column: TV_PR<br>value: 0.67856","row: Loilen<br>column: LLPHONE_PR<br>value: 0.15830","row: Loilen<br>column: MPHONE_PR<br>value: 0.30984","row: Loilen<br>column: COMPUTER_PR<br>value: 0.31369"],["row: Mongnai<br>column: RADIO_PR<br>value: 0.26836","row: Mongnai<br>column: TV_PR<br>value: 0.62151","row: Mongnai<br>column: LLPHONE_PR<br>value: 0.01981","row: Mongnai<br>column: MPHONE_PR<br>value: 0.33060","row: Mongnai<br>column: COMPUTER_PR<br>value: 0.27121"],["row: Monghsu<br>column: RADIO_PR<br>value: 0.39781","row: Monghsu<br>column: TV_PR<br>value: 0.54231","row: Monghsu<br>column: LLPHONE_PR<br>value: 0.07424","row: Monghsu<br>column: MPHONE_PR<br>value: 0.27845","row: Monghsu<br>column: COMPUTER_PR<br>value: 0.09064"],["row: Pinlaung<br>column: RADIO_PR<br>value: 0.38739","row: Pinlaung<br>column: TV_PR<br>value: 0.66163","row: Pinlaung<br>column: LLPHONE_PR<br>value: 0.21615","row: Pinlaung<br>column: MPHONE_PR<br>value: 0.30482","row: Pinlaung<br>column: COMPUTER_PR<br>value: 0.10624"],["row: Hopong<br>column: RADIO_PR<br>value: 0.32417","row: Hopong<br>column: TV_PR<br>value: 0.52815","row: Hopong<br>column: LLPHONE_PR<br>value: 0.24775","row: Hopong<br>column: MPHONE_PR<br>value: 0.24827","row: Hopong<br>column: COMPUTER_PR<br>value: 0.11437"],["row: Hsihseng<br>column: RADIO_PR<br>value: 0.42402","row: Hsihseng<br>column: TV_PR<br>value: 0.60545","row: Hsihseng<br>column: LLPHONE_PR<br>value: 0.24343","row: Hsihseng<br>column: MPHONE_PR<br>value: 0.15547","row: Hsihseng<br>column: COMPUTER_PR<br>value: 0.06254"],["row: Kyethi<br>column: RADIO_PR<br>value: 0.47696","row: Kyethi<br>column: TV_PR<br>value: 0.51463","row: Kyethi<br>column: LLPHONE_PR<br>value: 0.16424","row: Kyethi<br>column: MPHONE_PR<br>value: 0.07616","row: Kyethi<br>column: COMPUTER_PR<br>value: 0.09539"],["row: Ywangan<br>column: RADIO_PR<br>value: 1.00000","row: Ywangan<br>column: TV_PR<br>value: 0.22466","row: Ywangan<br>column: LLPHONE_PR<br>value: 0.07681","row: Ywangan<br>column: MPHONE_PR<br>value: 0.11998","row: Ywangan<br>column: COMPUTER_PR<br>value: 0.00000"],["row: Pindaya<br>column: RADIO_PR<br>value: 0.83755","row: Pindaya<br>column: TV_PR<br>value: 0.60476","row: Pindaya<br>column: LLPHONE_PR<br>value: 0.14309","row: Pindaya<br>column: MPHONE_PR<br>value: 0.18022","row: Pindaya<br>column: COMPUTER_PR<br>value: 0.09623"],["row: Pekon<br>column: RADIO_PR<br>value: 0.59806","row: Pekon<br>column: TV_PR<br>value: 0.65251","row: Pekon<br>column: LLPHONE_PR<br>value: 0.31085","row: Pekon<br>column: MPHONE_PR<br>value: 0.25526","row: Pekon<br>column: COMPUTER_PR<br>value: 0.16543"],["row: Nyaungshwe<br>column: RADIO_PR<br>value: 0.61041","row: Nyaungshwe<br>column: TV_PR<br>value: 0.68148","row: Nyaungshwe<br>column: LLPHONE_PR<br>value: 0.13607","row: Nyaungshwe<br>column: MPHONE_PR<br>value: 0.45032","row: Nyaungshwe<br>column: COMPUTER_PR<br>value: 0.12817"],["row: Lawksawk<br>column: RADIO_PR<br>value: 0.76399","row: Lawksawk<br>column: TV_PR<br>value: 0.79885","row: Lawksawk<br>column: LLPHONE_PR<br>value: 0.24106","row: Lawksawk<br>column: MPHONE_PR<br>value: 0.40650","row: Lawksawk<br>column: COMPUTER_PR<br>value: 0.19721"],["row: Monghpyak<br>column: RADIO_PR<br>value: 0.80742","row: Monghpyak<br>column: TV_PR<br>value: 0.60196","row: Monghpyak<br>column: LLPHONE_PR<br>value: 0.33321","row: Monghpyak<br>column: MPHONE_PR<br>value: 0.49415","row: Monghpyak<br>column: COMPUTER_PR<br>value: 0.23557"],["row: Kalaw<br>column: RADIO_PR<br>value: 0.50637","row: Kalaw<br>column: TV_PR<br>value: 0.77028","row: Kalaw<br>column: LLPHONE_PR<br>value: 0.32957","row: Kalaw<br>column: MPHONE_PR<br>value: 0.53272","row: Kalaw<br>column: COMPUTER_PR<br>value: 0.28660"],["row: Nansang<br>column: RADIO_PR<br>value: 0.32039","row: Nansang<br>column: TV_PR<br>value: 0.72999","row: Nansang<br>column: LLPHONE_PR<br>value: 0.29201","row: Nansang<br>column: MPHONE_PR<br>value: 0.39802","row: Nansang<br>column: COMPUTER_PR<br>value: 0.29808"],["row: Mongpan<br>column: RADIO_PR<br>value: 0.38034","row: Mongpan<br>column: TV_PR<br>value: 0.62360","row: Mongpan<br>column: LLPHONE_PR<br>value: 0.15774","row: Mongpan<br>column: MPHONE_PR<br>value: 0.57413","row: Mongpan<br>column: COMPUTER_PR<br>value: 0.47815"],["row: Kengtung<br>column: RADIO_PR<br>value: 0.47426","row: Kengtung<br>column: TV_PR<br>value: 0.81095","row: Kengtung<br>column: LLPHONE_PR<br>value: 0.50692","row: Kengtung<br>column: MPHONE_PR<br>value: 0.64507","row: Kengtung<br>column: COMPUTER_PR<br>value: 0.49016"],["row: Langkho<br>column: RADIO_PR<br>value: 0.37726","row: Langkho<br>column: TV_PR<br>value: 0.73224","row: Langkho<br>column: LLPHONE_PR<br>value: 0.60078","row: Langkho<br>column: MPHONE_PR<br>value: 0.52573","row: Langkho<br>column: COMPUTER_PR<br>value: 0.31702"],["row: Kunhing<br>column: RADIO_PR<br>value: 0.21741","row: Kunhing<br>column: TV_PR<br>value: 0.55496","row: Kunhing<br>column: LLPHONE_PR<br>value: 0.58982","row: Kunhing<br>column: MPHONE_PR<br>value: 0.43499","row: Kunhing<br>column: COMPUTER_PR<br>value: 0.24577"],["row: Laihka<br>column: RADIO_PR<br>value: 0.19771","row: Laihka<br>column: TV_PR<br>value: 0.73754","row: Laihka<br>column: LLPHONE_PR<br>value: 0.52643","row: Laihka<br>column: MPHONE_PR<br>value: 0.32190","row: Laihka<br>column: COMPUTER_PR<br>value: 0.26531"],["row: Mongla<br>column: RADIO_PR<br>value: 0.02528","row: Mongla<br>column: TV_PR<br>value: 0.86598","row: Mongla<br>column: LLPHONE_PR<br>value: 0.70640","row: Mongla<br>column: MPHONE_PR<br>value: 0.74203","row: Mongla<br>column: COMPUTER_PR<br>value: 0.66125"],["row: Mongyang<br>column: RADIO_PR<br>value: 0.00000","row: Mongyang<br>column: TV_PR<br>value: 0.70454","row: Mongyang<br>column: LLPHONE_PR<br>value: 0.93260","row: Mongyang<br>column: MPHONE_PR<br>value: 0.61887","row: Mongyang<br>column: COMPUTER_PR<br>value: 0.09584"],["row: Mongyawng<br>column: RADIO_PR<br>value: 0.49988","row: Mongyawng<br>column: TV_PR<br>value: 0.96872","row: Mongyawng<br>column: LLPHONE_PR<br>value: 1.00000","row: Mongyawng<br>column: MPHONE_PR<br>value: 0.41150","row: Mongyawng<br>column: COMPUTER_PR<br>value: 0.12401"],["row: Taunggyi<br>column: RADIO_PR<br>value: 0.71119","row: Taunggyi<br>column: TV_PR<br>value: 0.99354","row: Taunggyi<br>column: LLPHONE_PR<br>value: 0.66080","row: Taunggyi<br>column: MPHONE_PR<br>value: 0.78718","row: Taunggyi<br>column: COMPUTER_PR<br>value: 0.87235"],["row: Tachileik<br>column: RADIO_PR<br>value: 0.70646","row: Tachileik<br>column: TV_PR<br>value: 1.00000","row: Tachileik<br>column: LLPHONE_PR<br>value: 0.47796","row: Tachileik<br>column: MPHONE_PR<br>value: 1.00000","row: Tachileik<br>column: COMPUTER_PR<br>value: 1.00000"]],"colorscale":[[0,"#F7FBFF"],[0.0184863966262553,"#F3F8FD"],[0.0198098260803945,"#F3F8FD"],[0.0205146898168363,"#F3F8FD"],[0.0252801967260761,"#F2F7FD"],[0.0270171695974707,"#F1F7FD"],[0.0277191459892687,"#F1F7FD"],[0.0382966071330552,"#EFF5FC"],[0.0451632264769985,"#EDF4FB"],[0.0622520192843868,"#EAF2FA"],[0.0625392033019739,"#EAF2FA"],[0.0742383992580385,"#E8F1FA"],[0.076155538926932,"#E8F1FA"],[0.076811721112137,"#E7F0F9"],[0.0816442104969222,"#E6F0F9"],[0.0870417513913425,"#E5EFF9"],[0.0906415890041446,"#E4EFF9"],[0.0953876394162065,"#E4EEF8"],[0.0958373585557404,"#E4EEF8"],[0.0962326163868215,"#E3EEF8"],[0.106241449885522,"#E1EDF8"],[0.111904436916593,"#E0ECF7"],[0.114367263730804,"#E0ECF7"],[0.119978472699803,"#DEEBF7"],[0.124013663042729,"#DDEAF6"],[0.128166826505254,"#DDEAF6"],[0.136066148522307,"#DBE9F6"],[0.143087403531642,"#DAE8F5"],[0.155474604691974,"#D7E6F4"],[0.157742775419191,"#D7E6F4"],[0.158301980227552,"#D7E6F4"],[0.164238723886514,"#D6E5F4"],[0.165429291180986,"#D6E5F4"],[0.172433902024635,"#D4E4F3"],[0.180215108968874,"#D3E3F3"],[0.183148370737635,"#D2E3F3"],[0.184135302312723,"#D2E3F3"],[0.187495219279928,"#D1E2F2"],[0.197211649428868,"#D0E1F2"],[0.197710172154653,"#D0E1F2"],[0.198058043319845,"#CFE1F2"],[0.205926273043225,"#CEE0F1"],[0.209150932473573,"#CEE0F1"],[0.216148137218945,"#CCDFF1"],[0.217410671284228,"#CCDFF1"],[0.21842041426644,"#CBDEF0"],[0.219017992119371,"#CBDEF0"],[0.220256641261337,"#CBDEF0"],[0.220797228887767,"#CBDEF0"],[0.224658662397689,"#CBDEF0"],[0.235571306216099,"#C8DCEF"],[0.241057218342425,"#C8DCEF"],[0.243429304420374,"#C7DBEF"],[0.245771155383647,"#C6DBEF"],[0.247751053653138,"#C6DBEF"],[0.248272216763125,"#C6DBEF"],[0.255258118966462,"#C4DAEE"],[0.265312950401877,"#C0D8ED"],[0.266184392282222,"#C0D8ED"],[0.268361679188983,"#C0D8ED"],[0.271209462741391,"#BFD8EC"],[0.278454014117194,"#BCD7EB"],[0.286597658847325,"#BAD6EA"],[0.292007299760749,"#B8D5EA"],[0.295007664629742,"#B7D4EA"],[0.29808110156292,"#B6D4E9"],[0.304817572789695,"#B4D3E8"],[0.306758405782862,"#B4D3E8"],[0.309844721395711,"#B2D2E8"],[0.310848979879756,"#B2D2E8"],[0.313690332327921,"#B1D2E7"],[0.3170163548885,"#B0D1E7"],[0.320394747741001,"#AFD1E6"],[0.321903369400093,"#AFD1E6"],[0.324172132473446,"#AED0E6"],[0.329574745123248,"#ACD0E6"],[0.330600515260223,"#ACD0E6"],[0.333208981858478,"#ABCFE5"],[0.333936290902205,"#ABCFE5"],[0.363502861923713,"#A1CBE2"],[0.377255152198863,"#9DC9E0"],[0.380337395344116,"#9BC8E0"],[0.387386879011389,"#98C7DF"],[0.397810654522423,"#94C5DF"],[0.398016081357507,"#94C5DF"],[0.406501651460893,"#91C2DE"],[0.411501854757207,"#8FC1DD"],[0.423405327411151,"#8ABFDC"],[0.424024550834647,"#8ABFDC"],[0.434988683676573,"#85BCDB"],[0.450320578796944,"#7FB8DA"],[0.474260904706476,"#75B3D8"],[0.476955150368385,"#74B2D7"],[0.477957794194216,"#73B2D7"],[0.478151327305384,"#73B2D7"],[0.490156987615784,"#6FB0D6"],[0.49414581896158,"#6DAFD6"],[0.499881675740936,"#6BAED6"],[0.506368095822015,"#69ACD5"],[0.50691915233683,"#68ACD5"],[0.514633590303767,"#66AAD4"],[0.525729584351687,"#62A8D2"],[0.526425464373066,"#62A8D2"],[0.528153761284321,"#61A7D2"],[0.532717729177229,"#60A6D1"],[0.534801938410225,"#5FA6D1"],[0.542312990188334,"#5DA4D0"],[0.554958287541126,"#58A1CE"],[0.574129014267529,"#529DCC"],[0.589818495477126,"#4D9ACA"],[0.598063009080602,"#4A97C9"],[0.60078049382024,"#4A97C9"],[0.601959036958743,"#4997C9"],[0.604764072237741,"#4896C8"],[0.605446377144929,"#4896C8"],[0.61041100396026,"#4694C7"],[0.618872994218249,"#4393C6"],[0.621513143805108,"#4393C6"],[0.623598298101459,"#4292C6"],[0.645068858125427,"#3D8DC3"],[0.652510230228414,"#3B8BC2"],[0.660795705807666,"#3888C0"],[0.661247300170049,"#3888C0"],[0.661633001405188,"#3888C0"],[0.678560340092081,"#3383BE"],[0.681477967617962,"#3282BE"],[0.704540134897682,"#2C7CBB"],[0.706399443708488,"#2C7CBB"],[0.706455429707143,"#2C7CBB"],[0.711193230088641,"#2B7BBA"],[0.729986281010948,"#2676B7"],[0.732242201652944,"#2575B7"],[0.737540910773905,"#2474B6"],[0.742030952777324,"#2373B6"],[0.763988447341294,"#1E6DB2"],[0.770278323004509,"#1D6CB1"],[0.787178952652566,"#1967AD"],[0.798850415272024,"#1664AB"],[0.807417990884759,"#1562A9"],[0.810948735134979,"#1461A8"],[0.837546430318847,"#0F5AA3"],[0.865981571814495,"#09539D"],[0.872350492885991,"#08529C"],[0.932598506894785,"#084185"],[0.968718739178673,"#083877"],[0.993541542809373,"#08326D"],[1,"#08306B"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_306696ee48c8158f9b168eae66068fb5","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#F7FBFF"],[0.00334448160535117,"#F6FAFE"],[0.00668896321070234,"#F5F9FE"],[0.0100334448160535,"#F4F9FE"],[0.0133779264214047,"#F4F9FE"],[0.0167224080267559,"#F3F8FD"],[0.020066889632107,"#F3F8FD"],[0.0234113712374582,"#F2F7FD"],[0.0267558528428094,"#F1F7FD"],[0.0301003344481605,"#F0F6FC"],[0.0334448160535117,"#EFF6FC"],[0.0367892976588629,"#EFF6FC"],[0.040133779264214,"#EFF5FC"],[0.0434782608695652,"#EEF5FC"],[0.0468227424749164,"#EDF4FB"],[0.0501672240802676,"#ECF4FB"],[0.0535117056856187,"#ECF3FB"],[0.0568561872909699,"#ECF3FB"],[0.0602006688963211,"#EBF3FB"],[0.0635451505016722,"#EAF2FA"],[0.0668896321070234,"#E9F2FA"],[0.0702341137123746,"#E8F1FA"],[0.0735785953177257,"#E8F1FA"],[0.0769230769230769,"#E7F0F9"],[0.0802675585284281,"#E7F0F9"],[0.0836120401337793,"#E6F0F9"],[0.0869565217391304,"#E5EFF9"],[0.0903010033444816,"#E4EFF9"],[0.0936454849498328,"#E4EEF8"],[0.096989966555184,"#E3EEF8"],[0.100334448160535,"#E2EDF8"],[0.103678929765886,"#E2EDF8"],[0.107023411371237,"#E1EDF8"],[0.110367892976589,"#E1ECF7"],[0.11371237458194,"#E0ECF7"],[0.117056856187291,"#DFEBF7"],[0.120401337792642,"#DEEBF7"],[0.123745819397993,"#DDEAF6"],[0.127090301003344,"#DDEAF6"],[0.130434782608696,"#DDEAF6"],[0.133779264214047,"#DCE9F6"],[0.137123745819398,"#DBE9F6"],[0.140468227424749,"#DAE8F5"],[0.1438127090301,"#DAE8F5"],[0.147157190635451,"#D9E7F5"],[0.150501672240803,"#D9E7F5"],[0.153846153846154,"#D8E7F5"],[0.157190635451505,"#D7E6F4"],[0.160535117056856,"#D7E6F4"],[0.163879598662207,"#D6E5F4"],[0.167224080267559,"#D5E5F4"],[0.17056856187291,"#D5E5F4"],[0.173913043478261,"#D4E4F3"],[0.177257525083612,"#D4E4F3"],[0.180602006688963,"#D3E3F3"],[0.183946488294314,"#D2E3F3"],[0.187290969899666,"#D1E2F2"],[0.190635451505017,"#D1E2F2"],[0.193979933110368,"#D1E2F2"],[0.197324414715719,"#D0E1F2"],[0.20066889632107,"#CFE1F2"],[0.204013377926421,"#CEE0F1"],[0.207357859531773,"#CEE0F1"],[0.210702341137124,"#CDDFF1"],[0.214046822742475,"#CCDFF1"],[0.217391304347826,"#CCDFF1"],[0.220735785953177,"#CBDEF0"],[0.224080267558528,"#CBDEF0"],[0.22742474916388,"#CADDF0"],[0.230769230769231,"#C9DDF0"],[0.234113712374582,"#C8DCEF"],[0.237458193979933,"#C8DCEF"],[0.240802675585284,"#C8DCEF"],[0.244147157190635,"#C7DBEF"],[0.247491638795987,"#C6DBEF"],[0.250836120401338,"#C5DAEE"],[0.254180602006689,"#C4DAEE"],[0.25752508361204,"#C3D9EE"],[0.260869565217391,"#C2D9ED"],[0.264214046822742,"#C1D9ED"],[0.267558528428094,"#C0D8ED"],[0.270903010033445,"#BFD8EC"],[0.274247491638796,"#BED7EC"],[0.277591973244147,"#BCD7EB"],[0.280936454849498,"#BBD6EB"],[0.284280936454849,"#BBD6EB"],[0.287625418060201,"#BAD6EA"],[0.290969899665552,"#B9D5EA"],[0.294314381270903,"#B7D4EA"],[0.297658862876254,"#B6D4E9"],[0.301003344481605,"#B5D3E9"],[0.304347826086957,"#B4D3E8"],[0.307692307692308,"#B3D3E8"],[0.311036789297659,"#B2D2E8"],[0.31438127090301,"#B1D2E7"],[0.317725752508361,"#B0D1E7"],[0.321070234113712,"#AFD1E6"],[0.324414715719064,"#AED0E6"],[0.327759197324415,"#ACD0E6"],[0.331103678929766,"#ACD0E6"],[0.334448160535117,"#ABCFE5"],[0.337792642140468,"#AACFE5"],[0.341137123745819,"#A8CEE4"],[0.344481605351171,"#A7CEE4"],[0.347826086956522,"#A6CDE3"],[0.351170568561873,"#A5CDE3"],[0.354515050167224,"#A4CDE3"],[0.357859531772575,"#A3CCE3"],[0.361204013377926,"#A2CBE2"],[0.364548494983278,"#A1CBE2"],[0.367892976588629,"#A0CAE1"],[0.37123745819398,"#9FCAE1"],[0.374581939799331,"#9DC9E0"],[0.377926421404682,"#9CC9E0"],[0.381270903010033,"#9BC8E0"],[0.384615384615385,"#9AC7E0"],[0.387959866220736,"#98C7DF"],[0.391304347826087,"#97C6DF"],[0.394648829431438,"#96C5DF"],[0.397993311036789,"#94C5DF"],[0.40133779264214,"#93C4DE"],[0.404682274247492,"#92C3DE"],[0.408026755852843,"#90C2DE"],[0.411371237458194,"#8FC1DD"],[0.414715719063545,"#8DC0DD"],[0.418060200668896,"#8CC0DD"],[0.421404682274247,"#8BC0DD"],[0.424749163879599,"#89BFDC"],[0.42809364548495,"#88BEDC"],[0.431438127090301,"#87BDDC"],[0.434782608695652,"#85BCDB"],[0.438127090301003,"#84BBDB"],[0.441471571906354,"#82BADB"],[0.444816053511706,"#81BADB"],[0.448160535117057,"#80B9DA"],[0.451505016722408,"#7FB8DA"],[0.454849498327759,"#7DB8D9"],[0.45819397993311,"#7BB7D9"],[0.461538461538462,"#7AB6D9"],[0.464882943143813,"#79B5D8"],[0.468227424749164,"#78B5D8"],[0.471571906354515,"#77B4D8"],[0.474916387959866,"#75B3D8"],[0.478260869565217,"#73B2D7"],[0.481605351170569,"#72B1D7"],[0.48494983277592,"#71B1D7"],[0.488294314381271,"#6FB0D6"],[0.491638795986622,"#6EB0D6"],[0.494983277591973,"#6DAFD6"],[0.498327759197324,"#6BAED6"],[0.501672240802676,"#6AADD5"],[0.505016722408027,"#69ACD5"],[0.508361204013378,"#68ABD4"],[0.511705685618729,"#67ABD4"],[0.51505016722408,"#66AAD4"],[0.518394648829431,"#65AAD3"],[0.521739130434783,"#63A9D3"],[0.525083612040134,"#62A8D2"],[0.528428093645485,"#61A7D2"],[0.531772575250836,"#60A6D1"],[0.535117056856187,"#5FA6D1"],[0.538461538461538,"#5EA5D1"],[0.54180602006689,"#5DA4D0"],[0.545150501672241,"#5CA3D0"],[0.548494983277592,"#5AA3CF"],[0.551839464882943,"#59A2CF"],[0.555183946488294,"#58A1CE"],[0.558528428093645,"#58A1CE"],[0.561872909698997,"#56A0CE"],[0.565217391304348,"#559FCD"],[0.568561872909699,"#549ECD"],[0.57190635451505,"#539DCC"],[0.575250836120401,"#529CCC"],[0.578595317725752,"#509BCB"],[0.581939799331104,"#509BCB"],[0.585284280936455,"#4F9BCB"],[0.588628762541806,"#4E9ACA"],[0.591973244147157,"#4C99CA"],[0.595317725752508,"#4B98C9"],[0.598662207357859,"#4A97C9"],[0.602006688963211,"#4996C8"],[0.605351170568562,"#4896C8"],[0.608695652173913,"#4795C8"],[0.612040133779264,"#4694C7"],[0.615384615384615,"#4594C7"],[0.618729096989967,"#4393C6"],[0.622073578595318,"#4292C6"],[0.625418060200669,"#4292C6"],[0.62876254180602,"#4191C5"],[0.632107023411371,"#4090C5"],[0.635451505016722,"#3F8FC4"],[0.638795986622074,"#3E8EC4"],[0.642140468227425,"#3D8DC3"],[0.645484949832776,"#3C8CC3"],[0.648829431438127,"#3C8CC3"],[0.652173913043478,"#3B8BC2"],[0.655518394648829,"#3A8AC1"],[0.658862876254181,"#3989C1"],[0.662207357859532,"#3888C0"],[0.665551839464883,"#3787C0"],[0.668896321070234,"#3686BF"],[0.672240802675585,"#3585BF"],[0.675585284280936,"#3484BF"],[0.678929765886288,"#3383BE"],[0.682274247491639,"#3282BE"],[0.68561872909699,"#3181BD"],[0.688963210702341,"#3080BD"],[0.692307692307692,"#2F7FBC"],[0.695652173913043,"#2F7FBC"],[0.698996655518395,"#2E7EBC"],[0.702341137123746,"#2D7DBB"],[0.705685618729097,"#2C7CBB"],[0.709030100334448,"#2B7BBA"],[0.712374581939799,"#2A7AB9"],[0.71571906354515,"#2979B9"],[0.719063545150502,"#2979B9"],[0.722408026755853,"#2878B8"],[0.725752508361204,"#2777B8"],[0.729096989966555,"#2676B7"],[0.732441471571906,"#2575B7"],[0.735785953177257,"#2474B6"],[0.739130434782609,"#2474B6"],[0.74247491638796,"#2373B6"],[0.745819397993311,"#2272B5"],[0.749163879598662,"#2171B5"],[0.752508361204013,"#2070B4"],[0.755852842809364,"#1F6FB3"],[0.759197324414716,"#1E6EB2"],[0.762541806020067,"#1E6EB2"],[0.765886287625418,"#1E6DB2"],[0.769230769230769,"#1D6CB1"],[0.77257525083612,"#1C6BB0"],[0.775919732441472,"#1B6AAF"],[0.779264214046823,"#1A69AE"],[0.782608695652174,"#1A68AE"],[0.785953177257525,"#1A68AE"],[0.789297658862876,"#1967AD"],[0.792642140468227,"#1866AC"],[0.795986622073579,"#1765AB"],[0.79933110367893,"#1664AB"],[0.802675585284281,"#1663AA"],[0.806020066889632,"#1562A9"],[0.809364548494983,"#1562A9"],[0.812709030100334,"#1461A8"],[0.816053511705686,"#1360A7"],[0.819397993311037,"#135FA7"],[0.822742474916388,"#125EA6"],[0.826086956521739,"#115DA5"],[0.82943143812709,"#105CA4"],[0.832775919732441,"#105CA4"],[0.836120401337793,"#0F5BA3"],[0.839464882943144,"#0F5AA3"],[0.842809364548495,"#0E59A2"],[0.846153846153846,"#0D58A1"],[0.849498327759197,"#0C57A0"],[0.852842809364548,"#0C57A0"],[0.8561872909699,"#0C56A0"],[0.859531772575251,"#0B559F"],[0.862876254180602,"#0A549E"],[0.866220735785953,"#09539D"],[0.869565217391304,"#08529C"],[0.872909698996655,"#08519C"],[0.876254180602007,"#08519B"],[0.879598662207358,"#08509A"],[0.882943143812709,"#084F99"],[0.88628762541806,"#084E97"],[0.889632107023411,"#084C96"],[0.892976588628763,"#084B95"],[0.896321070234114,"#084A93"],[0.899665551839465,"#084A92"],[0.903010033444816,"#084990"],[0.906354515050167,"#08488F"],[0.909698996655518,"#08478E"],[0.91304347826087,"#08468C"],[0.916387959866221,"#08458B"],[0.919732441471572,"#08448A"],[0.923076923076923,"#084489"],[0.926421404682274,"#084388"],[0.929765886287625,"#084286"],[0.933110367892977,"#084185"],[0.936454849498328,"#084083"],[0.939799331103679,"#083F82"],[0.94314381270903,"#083E81"],[0.946488294314381,"#083E7F"],[0.949832775919732,"#083D7E"],[0.953177257525084,"#083C7D"],[0.956521739130435,"#083B7B"],[0.959866220735786,"#083A7A"],[0.963210702341137,"#083979"],[0.966555183946488,"#083978"],[0.969899665551839,"#083876"],[0.973244147157191,"#083775"],[0.976588628762542,"#083674"],[0.979933110367893,"#083572"],[0.983277591973244,"#083471"],[0.986622073578595,"#083370"],[0.989966555183946,"#08336F"],[0.993311036789298,"#08326D"],[0.996655518394649,"#08316C"],[1,"#08306B"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.997325054555081,0.997325054555081,null,0.997325054555081,0.752845210697589,null,0.752845210697589,0.752845210697589,null,0.752845210697589,0.539728239232976,null,0.539728239232976,0.539728239232976,null,0.539728239232976,0.486212301448335,null,0.486212301448335,0.486212301448335,null,0.486212301448335,0.324549989082506,null,0.324549989082506,0.324549989082506,null,0.324549989082506,0.236425995139046,null,0.236425995139046,0.236425995139046,null,0.236425995139046,0,null,0.236425995139046,0.236425995139046,null,0.236425995139046,0,null,0.324549989082506,0.324549989082506,null,0.324549989082506,0,null,0.486212301448335,0.486212301448335,null,0.486212301448335,0.261981539088998,null,0.261981539088998,0.261981539088998,null,0.261981539088998,0,null,0.261981539088998,0.261981539088998,null,0.261981539088998,0,null,0.539728239232976,0.539728239232976,null,0.539728239232976,0.225639913186082,null,0.225639913186082,0.225639913186082,null,0.225639913186082,0,null,0.225639913186082,0.225639913186082,null,0.225639913186082,0,null,0.752845210697589,0.752845210697589,null,0.752845210697589,0],"y":[26.984375,25.46875,null,25.46875,25.46875,null,25.46875,23.9375,null,23.9375,23.9375,null,23.9375,22.375,null,22.375,22.375,null,22.375,21.25,null,21.25,21.25,null,21.25,20.5,null,20.5,20.5,null,20.5,20,null,20,20,null,20.5,21,null,21,21,null,21.25,22,null,22,22,null,22.375,23.5,null,23.5,23.5,null,23.5,23,null,23,23,null,23.5,24,null,24,24,null,23.9375,25.5,null,25.5,25.5,null,25.5,25,null,25,25,null,25.5,26,null,26,26,null,25.46875,27,null,27,27],"text":["y: 0.9973251","y: 0.9973251",null,"y: 0.9973251","y: 0.9973251",null,"y: 0.7528452","y: 0.7528452",null,"y: 0.7528452","y: 0.7528452",null,"y: 0.5397282","y: 0.5397282",null,"y: 0.5397282","y: 0.5397282",null,"y: 0.4862123","y: 0.4862123",null,"y: 0.4862123","y: 0.4862123",null,"y: 0.3245500","y: 0.3245500",null,"y: 0.3245500","y: 0.3245500",null,"y: 0.2364260","y: 0.2364260",null,"y: 0.2364260","y: 0.2364260",null,"y: 0.2364260","y: 0.2364260",null,"y: 0.2364260","y: 0.2364260",null,"y: 0.3245500","y: 0.3245500",null,"y: 0.3245500","y: 0.3245500",null,"y: 0.4862123","y: 0.4862123",null,"y: 0.4862123","y: 0.4862123",null,"y: 0.2619815","y: 0.2619815",null,"y: 0.2619815","y: 0.2619815",null,"y: 0.2619815","y: 0.2619815",null,"y: 0.2619815","y: 0.2619815",null,"y: 0.5397282","y: 0.5397282",null,"y: 0.5397282","y: 0.5397282",null,"y: 0.2256399","y: 0.2256399",null,"y: 0.2256399","y: 0.2256399",null,"y: 0.2256399","y: 0.2256399",null,"y: 0.2256399","y: 0.2256399",null,"y: 0.7528452","y: 0.7528452",null,"y: 0.7528452","y: 0.7528452"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.997325054555081,0.997325054555081,null,0.997325054555081,0.606639662064841,null,0.606639662064841,0.606639662064841,null,0.606639662064841,0,null,0.606639662064841,0.606639662064841,null,0.606639662064841,0],"y":[26.984375,28.5,null,28.5,28.5,null,28.5,28,null,28,28,null,28.5,29,null,29,29],"text":["y: 0.9973251","y: 0.9973251",null,"y: 0.9973251","y: 0.9973251",null,"y: 0.6066397","y: 0.6066397",null,"y: 0.6066397","y: 0.6066397",null,"y: 0.6066397","y: 0.6066397",null,"y: 0.6066397","y: 0.6066397"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(125,176,221,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.08051523650094,1.08051523650094,null,1.08051523650094,0.730316487596654,null,0.730316487596654,0.730316487596654,null,0.730316487596654,0,null,0.730316487596654,0.730316487596654,null,0.730316487596654,0.393737941772191,null,0.393737941772191,0.393737941772191,null,0.393737941772191,0,null,0.393737941772191,0.393737941772191,null,0.393737941772191,0.329957780205042,null,0.329957780205042,0.329957780205042,null,0.329957780205042,0.278751350160453,null,0.278751350160453,0.278751350160453,null,0.278751350160453,0,null,0.278751350160453,0.278751350160453,null,0.278751350160453,0.234675804656484,null,0.234675804656484,0.234675804656484,null,0.234675804656484,0,null,0.234675804656484,0.234675804656484,null,0.234675804656484,0,null,0.329957780205042,0.329957780205042,null,0.329957780205042,0],"y":[10.359375,15.21875,null,15.21875,15.21875,null,15.21875,14,null,14,14,null,15.21875,16.4375,null,16.4375,16.4375,null,16.4375,15,null,15,15,null,16.4375,17.875,null,17.875,17.875,null,17.875,16.75,null,16.75,16.75,null,16.75,16,null,16,16,null,16.75,17.5,null,17.5,17.5,null,17.5,17,null,17,17,null,17.5,18,null,18,18,null,17.875,19,null,19,19],"text":["y: 1.0805152","y: 1.0805152",null,"y: 1.0805152","y: 1.0805152",null,"y: 0.7303165","y: 0.7303165",null,"y: 0.7303165","y: 0.7303165",null,"y: 0.7303165","y: 0.7303165",null,"y: 0.7303165","y: 0.7303165",null,"y: 0.3937379","y: 0.3937379",null,"y: 0.3937379","y: 0.3937379",null,"y: 0.3937379","y: 0.3937379",null,"y: 0.3937379","y: 0.3937379",null,"y: 0.3299578","y: 0.3299578",null,"y: 0.3299578","y: 0.3299578",null,"y: 0.2787514","y: 0.2787514",null,"y: 0.2787514","y: 0.2787514",null,"y: 0.2787514","y: 0.2787514",null,"y: 0.2787514","y: 0.2787514",null,"y: 0.2346758","y: 0.2346758",null,"y: 0.2346758","y: 0.2346758",null,"y: 0.2346758","y: 0.2346758",null,"y: 0.2346758","y: 0.2346758",null,"y: 0.3299578","y: 0.3299578",null,"y: 0.3299578","y: 0.3299578"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(134,184,117,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.796630560118433,0.796630560118433,null,0.796630560118433,0.471070180174569,null,0.471070180174569,0.471070180174569,null,0.471070180174569,0.428103604619641,null,0.428103604619641,0.428103604619641,null,0.428103604619641,0.287836658108553,null,0.287836658108553,0.287836658108553,null,0.287836658108553,0.218646492487333,null,0.218646492487333,0.218646492487333,null,0.218646492487333,0,null,0.218646492487333,0.218646492487333,null,0.218646492487333,0,null,0.287836658108553,0.287836658108553,null,0.287836658108553,0,null,0.428103604619641,0.428103604619641,null,0.428103604619641,0.184043541196074,null,0.184043541196074,0.184043541196074,null,0.184043541196074,0,null,0.184043541196074,0.184043541196074,null,0.184043541196074,0,null,0.471070180174569,0.471070180174569,null,0.471070180174569,0.29108421500061,null,0.29108421500061,0.29108421500061,null,0.29108421500061,0.192882361714866,null,0.192882361714866,0.192882361714866,null,0.192882361714866,0,null,0.192882361714866,0.192882361714866,null,0.192882361714866,0.161477435541523,null,0.161477435541523,0.161477435541523,null,0.161477435541523,0,null,0.161477435541523,0.161477435541523,null,0.161477435541523,0,null,0.29108421500061,0.29108421500061,null,0.29108421500061,0.15713145011467,null,0.15713145011467,0.15713145011467,null,0.15713145011467,0,null,0.15713145011467,0.15713145011467,null,0.15713145011467,0],"y":[5.5,8.75,null,8.75,8.75,null,8.75,6.375,null,6.375,6.375,null,6.375,5.25,null,5.25,5.25,null,5.25,4.5,null,4.5,4.5,null,4.5,4,null,4,4,null,4.5,5,null,5,5,null,5.25,6,null,6,6,null,6.375,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,8.75,11.125,null,11.125,11.125,null,11.125,9.75,null,9.75,9.75,null,9.75,9,null,9,9,null,9.75,10.5,null,10.5,10.5,null,10.5,10,null,10,10,null,10.5,11,null,11,11,null,11.125,12.5,null,12.5,12.5,null,12.5,12,null,12,12,null,12.5,13,null,13,13],"text":["y: 0.7966306","y: 0.7966306",null,"y: 0.7966306","y: 0.7966306",null,"y: 0.4710702","y: 0.4710702",null,"y: 0.4710702","y: 0.4710702",null,"y: 0.4281036","y: 0.4281036",null,"y: 0.4281036","y: 0.4281036",null,"y: 0.2878367","y: 0.2878367",null,"y: 0.2878367","y: 0.2878367",null,"y: 0.2186465","y: 0.2186465",null,"y: 0.2186465","y: 0.2186465",null,"y: 0.2186465","y: 0.2186465",null,"y: 0.2186465","y: 0.2186465",null,"y: 0.2878367","y: 0.2878367",null,"y: 0.2878367","y: 0.2878367",null,"y: 0.4281036","y: 0.4281036",null,"y: 0.4281036","y: 0.4281036",null,"y: 0.1840435","y: 0.1840435",null,"y: 0.1840435","y: 0.1840435",null,"y: 0.1840435","y: 0.1840435",null,"y: 0.1840435","y: 0.1840435",null,"y: 0.4710702","y: 0.4710702",null,"y: 0.4710702","y: 0.4710702",null,"y: 0.2910842","y: 0.2910842",null,"y: 0.2910842","y: 0.2910842",null,"y: 0.1928824","y: 0.1928824",null,"y: 0.1928824","y: 0.1928824",null,"y: 0.1928824","y: 0.1928824",null,"y: 0.1928824","y: 0.1928824",null,"y: 0.1614774","y: 0.1614774",null,"y: 0.1614774","y: 0.1614774",null,"y: 0.1614774","y: 0.1614774",null,"y: 0.1614774","y: 0.1614774",null,"y: 0.2910842","y: 0.2910842",null,"y: 0.2910842","y: 0.2910842",null,"y: 0.1571315","y: 0.1571315",null,"y: 0.1571315","y: 0.1571315",null,"y: 0.1571315","y: 0.1571315",null,"y: 0.1571315","y: 0.1571315"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(199,167,108,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.32508183159135,1.32508183159135,null,1.32508183159135,0.30835216101953,null,0.30835216101953,0.30835216101953,null,0.30835216101953,0,null,0.30835216101953,0.30835216101953,null,0.30835216101953,0],"y":[28.7421875,30.5,null,30.5,30.5,null,30.5,30,null,30,30,null,30.5,31,null,31,31],"text":["y: 1.3250818","y: 1.3250818",null,"y: 1.3250818","y: 1.3250818",null,"y: 0.3083522","y: 0.3083522",null,"y: 0.3083522","y: 0.3083522",null,"y: 0.3083522","y: 0.3083522",null,"y: 0.3083522","y: 0.3083522"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(205,153,216,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.796630560118433,0.796630560118433,null,0.796630560118433,0.418607575203318,null,0.418607575203318,0.418607575203318,null,0.418607575203318,0.236105974434174,null,0.236105974434174,0.236105974434174,null,0.236105974434174,0,null,0.236105974434174,0.236105974434174,null,0.236105974434174,0,null,0.418607575203318,0.418607575203318,null,0.418607575203318,0],"y":[5.5,2.25,null,2.25,2.25,null,2.25,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.25,3,null,3,3],"text":["y: 0.7966306","y: 0.7966306",null,"y: 0.7966306","y: 0.7966306",null,"y: 0.4186076","y: 0.4186076",null,"y: 0.4186076","y: 0.4186076",null,"y: 0.2361060","y: 0.2361060",null,"y: 0.2361060","y: 0.2361060",null,"y: 0.2361060","y: 0.2361060",null,"y: 0.2361060","y: 0.2361060",null,"y: 0.4186076","y: 0.4186076",null,"y: 0.4186076","y: 0.4186076"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.82345321314226,1.82345321314226,null,1.82345321314226,1.08051523650094,null,1.08051523650094,1.08051523650094,null,1.08051523650094,0.796630560118433,null,1.82345321314226,1.82345321314226,null,1.82345321314226,1.32508183159135,null,1.32508183159135,1.32508183159135,null,1.32508183159135,0.997325054555081],"y":[19.55078125,10.359375,null,10.359375,10.359375,null,10.359375,5.5,null,5.5,5.5,null,19.55078125,28.7421875,null,28.7421875,28.7421875,null,28.7421875,26.984375,null,26.984375,26.984375],"text":["y: 1.8234532","y: 1.8234532",null,"y: 1.8234532","y: 1.8234532",null,"y: 1.0805152","y: 1.0805152",null,"y: 1.0805152","y: 1.0805152",null,"y: 1.8234532","y: 1.8234532",null,"y: 1.8234532","y: 1.8234532",null,"y: 1.3250818","y: 1.3250818",null,"y: 1.3250818","y: 1.3250818"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.82345321314226,1.08051523650094,0.796630560118433,0.418607575203318,0.236105974434174,0,0,0,0.471070180174569,0.428103604619641,0.287836658108553,0.218646492487333,0,0,0,0.184043541196074,0,0,0.29108421500061,0.192882361714866,0,0.161477435541523,0,0,0.15713145011467,0,0,0.730316487596654,0,0.393737941772191,0,0.329957780205042,0.278751350160453,0,0.234675804656484,0,0,0,1.32508183159135,0.997325054555081,0.752845210697589,0.539728239232976,0.486212301448335,0.324549989082506,0.236425995139046,0,0,0,0.261981539088998,0,0,0.225639913186082,0,0,0,0.606639662064841,0,0,0.30835216101953,0,0],"y":[19.55078125,10.359375,5.5,2.25,1.5,1,2,3,8.75,6.375,5.25,4.5,4,5,6,7.5,7,8,11.125,9.75,9,10.5,10,11,12.5,12,13,15.21875,14,16.4375,15,17.875,16.75,16,17.5,17,18,19,28.7421875,26.984375,25.46875,23.9375,22.375,21.25,20.5,20,21,22,23.5,23,24,25.5,25,26,27,28.5,28,29,30.5,30,31],"text":["y: 1.8234532","y: 1.0805152","y: 0.7966306","y: 0.4186076","y: 0.2361060","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.4710702","y: 0.4281036","y: 0.2878367","y: 0.2186465","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.1840435","y: 0.0000000","y: 0.0000000","y: 0.2910842","y: 0.1928824","y: 0.0000000","y: 0.1614774","y: 0.0000000","y: 0.0000000","y: 0.1571315","y: 0.0000000","y: 0.0000000","y: 0.7303165","y: 0.0000000","y: 0.3937379","y: 0.0000000","y: 0.3299578","y: 0.2787514","y: 0.0000000","y: 0.2346758","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 1.3250818","y: 0.9973251","y: 0.7528452","y: 0.5397282","y: 0.4862123","y: 0.3245500","y: 0.2364260","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.2619815","y: 0.0000000","y: 0.0000000","y: 0.2256399","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.6066397","y: 0.0000000","y: 0.0000000","y: 0.3083522","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"automargin":true,"type":"linear","autorange":false,"range":[0.5,5.5],"tickmode":"array","ticktext":["RADIO_PR","TV_PR","LLPHONE_PR","MPHONE_PR","COMPUTER_PR"],"tickvals":[1,2,3,4,5],"categoryorder":"array","categoryarray":["RADIO_PR","TV_PR","LLPHONE_PR","MPHONE_PR","COMPUTER_PR"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":6.6417600664176},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"ICT Indicators","hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1.82345321314226],"tickmode":"array","ticktext":["0.0","0.5","1.0","1.5"],"tickvals":[0,0.5,1,1.5],"categoryorder":"array","categoryarray":["0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":null,"family":null,"size":0}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,31.5],"tickmode":"array","ticktext":["Mongkaing","Mawkmai","Mongkhet","Mongping","Mongton","Monghsat","Loilen","Mongnai","Monghsu","Pinlaung","Hopong","Hsihseng","Kyethi","Ywangan","Pindaya","Pekon","Nyaungshwe","Lawksawk","Monghpyak","Kalaw","Nansang","Mongpan","Kengtung","Langkho","Kunhing","Laihka","Mongla","Mongyang","Mongyawng","Taunggyi","Tachileik"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],"categoryorder":"array","categoryarray":["Mongkaing","Mawkmai","Mongkhet","Mongping","Mongton","Monghsat","Loilen","Mongnai","Monghsu","Pinlaung","Hopong","Hsihseng","Kyethi","Ywangan","Pindaya","Pekon","Nyaungshwe","Lawksawk","Monghpyak","Kalaw","Nansang","Mongpan","Kengtung","Langkho","Kunhing","Laihka","Mongla","Mongyang","Mongyawng","Taunggyi","Tachileik"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":5.31340805313408},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Townships of Shan State","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":60,"r":null,"b":35.0684931506849,"l":200},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Geographic Segmentation of Shan State by ICT indicators"},"attrs":{"c185a4148a":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"},"c185e57c65":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"scatter"},"c18c9f746c":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="mapping-the-clusters-formed." class="level4">
<h4 class="anchored" data-anchor-id="mapping-the-clusters-formed.">6.7.5 Mapping the clusters formed.</h4>
<p>With closed examination of the dendragram above, we have decided to retain six clusters.</p>
<p><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/cutree.html"><em>cutree()</em></a> of R Base will be used in the code chunk below to derive a 6-cluster model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(hclust_ward, <span class="at">k=</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output is called <em>groups</em>. It is a <em>list</em> object.</p>
<p>In order to visualize the clusters, the <em>groups</em> object need to be appended onto <em>shan_sf</em> simple feature object.</p>
<p>The code chunk below form the join in three steps:</p>
<ul>
<li><p>the <em>groups</em> list object will be converted into a matrix;</p></li>
<li><p><em>cbind()</em> is used to append <em>groups</em> matrix onto shan_sf to produce an output simple feature object called <code>shan_sf_cluster</code>; and</p></li>
<li><p><em>rename</em> of <strong>dplyr</strong> package is used to rename <em>as.matrix.groups</em> field as <em>CLUSTER</em>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>shan_sf_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf_final, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, <em>qtm()</em> of <strong>tmap</strong> package is used to plot the choropleth map showing the cluster formed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_cluster, <span class="st">"CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The choropleth map above reveals the clusters are very fragmented. The is one of the major limitation when non-spatial clustering algorithm such as hierarchical cluster analysis method is used.</p>
</section>
</section>
</section>
<section id="spatially-constrained-clustering-skater-approach." class="level2">
<h2 class="anchored" data-anchor-id="spatially-constrained-clustering-skater-approach.">7. Spatially Constrained Clustering: SKATER approach.</h2>
<p>In this section, we will learn how to derive spatially constrained cluster by using <a href="https://r-spatial.github.io/spdep/reference/skater.html"><em>skater()</em></a> method of <a href="https://r-spatial.github.io/spdep/"><strong>spdep</strong></a> package.</p>
<section id="converting-into-spatialpolygonsdataframe" class="level3">
<h3 class="anchored" data-anchor-id="converting-into-spatialpolygonsdataframe">7.1 Converting into SpatialPolygonsDataFrame</h3>
<p>First, we need to convert <code>shan_sf</code> into SpatialPolygonsDataFrame. This is because SKATER function only support <strong>sp</strong> objects such as SpatialPolygonDataFrame.</p>
<p>The code chunk below uses <a href="https://r-spatial.github.io/sf/reference/coerce-methods.html"><em>as_Spatial()</em></a> of <strong>sf</strong> package to convert <em>shan_sf</em> into a SpatialPolygonDataFrame called <em>shan_sp</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>shan_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(shan_sf_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="computing-neighbour-list." class="level3">
<h3 class="anchored" data-anchor-id="computing-neighbour-list.">7.2 Computing Neighbour List.</h3>
<p>Next, <a href="https://r-spatial.github.io/spdep/reference/poly2nb.html">poly2nd()</a> of <strong>spdep</strong> package will be used to compute the neighbours list from polygon list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>shan.nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(shan_sp)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 31 
Number of nonzero links: 138 
Percentage nonzero weights: 14.36004 
Average number of links: 4.451613 
Link number distribution:

 2  3  4  5  6  7 
 3  6  3 14  3  2 
3 least connected regions:
2 5 29 with 2 links
2 most connected regions:
8 18 with 7 links</code></pre>
</div>
</div>
<p>We can plot the neighbours list on shan_sp by using the code chunk below. Since we now can plot the community area boundaries as well, we plot this graph on top of the map. The first plot command gives the boundaries. This is followed by the plot of the neighbor list object, with coordinates applied to the original SpatialPolygonDataFrame (Shan state township boundaries) to extract the centroids of the polygons. These are used as the nodes for the graph representation. We also set the color to blue and specify add=TRUE to plot the network on top of the boundaries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="fu">grey</span>(.<span class="dv">5</span>))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan.nb, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that if you plot the network first and then the boundaries, some of the areas will be clipped. This is because the plotting area is determined by the characteristics of the first plot. In this example, because the boundary map extends further than the graph, we plot it first.</p>
</section>
<section id="computing-minimum-spanning-tree." class="level3">
<h3 class="anchored" data-anchor-id="computing-minimum-spanning-tree.">7.3 Computing minimum spanning tree.</h3>
<section id="section-4" class="level4">
<h4 class="anchored" data-anchor-id="section-4"></h4>
<p>7.3.1 Calculating edge costs.</p>
<p>Next, <a href="https://r-spatial.github.io/spdep/reference/nbcosts.html"><em>nbcosts()</em></a> of <strong>spdep</strong> package is used to compute the cost of each edge. It is the distance between it nodes. This function compute this distance using a data.frame with observations vector in each node.</p>
<p>The code chunk below is used to compute the cost of each edge.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>lcosts <span class="ot">&lt;-</span> <span class="fu">nbcosts</span>(shan.nb, shan_ict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For each observation, this gives the pairwise dissimilarity between its values on the five variables and the values for the neighbouring observation (from the neighbour list). Basically, this is the notion of a generalised weight for a spatial weights matrix.</p>
<p>Next, We will incorporate these costs into a weights object in the same way as we did in the calculation of inverse of distance weights. In other words, we convert the neighbour list to a list weights object by specifying the just computed <strong><em>lcosts</em></strong> as the weights.</p>
<p>In order to achieve this, <a href="https://r-spatial.github.io/spdep/reference/nb2listw.html"><em>nb2listw()</em></a> of <strong>spdep</strong> package is used as shown in the code chunk below.</p>
<p>Note that we specify the <em>style</em> as <strong>B</strong> to make sure the cost values are not row-standardized.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>shan.w <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(shan.nb, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                   lcosts, </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"B"</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(shan.w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 31 
Number of nonzero links: 138 
Percentage nonzero weights: 14.36004 
Average number of links: 4.451613 
Link number distribution:

 2  3  4  5  6  7 
 3  6  3 14  3  2 
3 least connected regions:
2 5 29 with 2 links
2 most connected regions:
8 18 with 7 links

Weights style: B 
Weights constants summary:
   n  nn       S0       S1        S2
B 31 961 37117.89 26381006 209806773</code></pre>
</div>
</div>
</section>
<section id="computing-minimum-spanning-tree.-1" class="level4">
<h4 class="anchored" data-anchor-id="computing-minimum-spanning-tree.-1">7.3.2 Computing minimum spanning tree.</h4>
<p>The minimum spanning tree is computed by mean of the <a href="https://r-spatial.github.io/spdep/reference/mstree.html"><em>mstree()</em></a> of <strong>spdep</strong> package as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>shan.mst <span class="ot">&lt;-</span> <span class="fu">mstree</span>(shan.w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After computing the MST, we can check its class and dimension by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(shan.mst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mst"    "matrix"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(shan.mst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30  3</code></pre>
</div>
</div>
<p>Dimension are 30 x 3.</p>
<p>We can display the content of <em>shan.mst</em> by using <em>head()</em> as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shan.mst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]     [,3]
[1,]   31   17 285.5647
[2,]   17   23 221.4761
[3,]   23   22 202.4500
[4,]   22   29 146.6666
[5,]   17   15 356.8492
[6,]   15   18 140.9539</code></pre>
</div>
</div>
<p>The plot method for the MST include a way to show the observation numbers of the nodes in addition to the edge. As before, we plot this together with the township boundaries. We can see how the initial neighbour list is simplified to just one edge connecting each of the nodes, while passing through all the nodes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.mst</span>(shan.mst, </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.lab=</span><span class="fl">0.7</span>, </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex.circles=</span><span class="fl">0.005</span>, </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="computing-spatially-constrained-clusters-using-skater-method." class="level3">
<h3 class="anchored" data-anchor-id="computing-spatially-constrained-clusters-using-skater-method.">7.4 Computing spatially constrained clusters using SKATER method.</h3>
<p>The code chunk below compute the spatially constrained cluster using <a href="https://r-spatial.github.io/spdep/reference/skater.html"><em>skater()</em></a> of <strong>spdep</strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>clust6 <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">skater</span>(<span class="at">edges =</span> shan.mst[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> shan_ict, </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"euclidean"</span>, </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncuts =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <em>skater()</em> takes three mandatory arguments: - the first two columns of the MST matrix (i.e.&nbsp;not the cost), - the data matrix (to update the costs as units are being grouped), and - the number of cuts. Note: It is set to <strong>one less than the number of clusters</strong>. So, the value specified is <strong>not</strong> the number of clusters, but the number of cuts in the graph, one less than the number of clusters.</p>
<p>The result of the <em>skater()</em> is an object of class <strong>skater</strong>. We can examine its contents by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(clust6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 8
 $ groups      : num [1:31] 3 5 3 3 3 3 2 2 2 2 ...
 $ edges.groups:List of 6
  ..$ :List of 3
  .. ..$ node: num [1:6] 17 31 23 22 13 29
  .. ..$ edge: num [1:5, 1:3] 31 23 22 17 31 13 22 29 23 17 ...
  .. ..$ ssw : num 1149
  ..$ :List of 3
  .. ..$ node: num [1:16] 27 8 21 25 18 10 24 30 19 15 ...
  .. ..$ edge: num [1:15, 1:3] 21 8 18 10 18 24 25 19 15 30 ...
  .. ..$ ssw : num 2246
  ..$ :List of 3
  .. ..$ node: num [1:6] 4 6 20 3 1 5
  .. ..$ edge: num [1:5, 1:3] 6 20 3 4 20 1 3 5 6 4 ...
  .. ..$ ssw : num 650
  ..$ :List of 3
  .. ..$ node: num 11
  .. ..$ edge: num[0 , 1:3] 
  .. ..$ ssw : num 0
  ..$ :List of 3
  .. ..$ node: num 2
  .. ..$ edge: num[0 , 1:3] 
  .. ..$ ssw : num 0
  ..$ :List of 3
  .. ..$ node: num 26
  .. ..$ edge: num[0 , 1:3] 
  .. ..$ ssw : num 0
 $ not.prune   : NULL
 $ candidates  : int [1:6] 1 2 3 4 5 6
 $ ssto        : num 6532
 $ ssw         : num [1:6] 6532 5744 5226 4802 4397 ...
 $ crit        : num [1:2] 1 Inf
 $ vec.crit    : num [1:31] 1 1 1 1 1 1 1 1 1 1 ...
 - attr(*, "class")= chr "skater"</code></pre>
</div>
</div>
<p>The most interesting component of this list structure is the groups vector containing the labels of the cluster to which each observation belongs (as before, the label itself is arbitary). This is followed by a detailed summary for each of the clusters in the edges.groups list. Sum of squares measures are given as ssto for the total and ssw to show the effect of each of the cuts on the overall criterion.</p>
<p>We can check the cluster assignment by using the conde chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>ccs6 <span class="ot">&lt;-</span> clust6<span class="sc">$</span>groups</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>ccs6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 3 5 3 3 3 3 2 2 2 2 4 2 1 2 2 2 1 2 2 3 2 1 1 2 2 6 2 2 1 2 1</code></pre>
</div>
</div>
<p>We can find out how many observations are in each cluster by means of the table command. Parenthetially, we can also find this as the dimension of each vector in the lists contained in edges.groups. For example, the first list has node with dimension 12, which is also the number of observations in the first cluster.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ccs6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ccs6
 1  2  3  4  5  6 
 6 16  6  1  1  1 </code></pre>
</div>
</div>
<p>Lastly, we can also plot the pruned tree that shows the five clusters on top of the townshop area</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shan_sp, <span class="at">border=</span><span class="fu">gray</span>(.<span class="dv">5</span>))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clust6, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coordinates</span>(shan_sp), </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span>.<span class="dv">7</span>,</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">groups.colors=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"green"</span>,<span class="st">"blue"</span>, <span class="st">"brown"</span>, <span class="st">"pink"</span>),</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.circles=</span><span class="fl">0.005</span>, </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1],
coords[id2, : "add" is not a graphical parameter

Warning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1],
coords[id2, : "add" is not a graphical parameter

Warning in segments(coords[id1, 1], coords[id1, 2], coords[id2, 1],
coords[id2, : "add" is not a graphical parameter</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="visualizing-the-clusters-in-choropleth-map." class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-clusters-in-choropleth-map.">7.5 Visualizing the clusters in choropleth map.</h3>
<p>The code chunk below is used to plot the newly derived clusters by using SKATER method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>groups_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(clust6<span class="sc">$</span>groups)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>shan_sf_spatialcluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf_cluster, <span class="fu">as.factor</span>(groups_mat)) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">SP_CLUSTER</span><span class="st">`</span><span class="ot">=</span><span class="st">`</span><span class="at">as.factor.groups_mat.</span><span class="st">`</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_spatialcluster, <span class="st">"SP_CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>For easy comparison, it will be better to place both the hierarchical clustering and spatially constrained hierarchical clustering maps next to each other.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>hclust.map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(shan_sf_cluster,</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"CLUSTER"</span>) <span class="sc">+</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>shclust.map <span class="ot">&lt;-</span> <span class="fu">qtm</span>(shan_sf_spatialcluster,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SP_CLUSTER"</span>) <span class="sc">+</span> </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(hclust.map, shclust.map,</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).

Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="spatially-constrained-clustering-clustgeo-method." class="level2">
<h2 class="anchored" data-anchor-id="spatially-constrained-clustering-clustgeo-method.">8. Spatially Constrained Clustering: ClustGeo Method.</h2>
<p>In this section, we will gain hands-on experience on using functions provided by <strong>ClustGeo</strong> package to perform non-spatially constrained hierarchical cluster analysis and spatially constrained cluster analysis.</p>
<p><a href="https://cran.r-project.org/web/packages/ClustGeo/"><strong>ClustGeo</strong></a> package is an R package specially designed to support the need of performing spatially constrained cluster analysis. More specifically, it provides a Ward-like hierarchical clustering algorithm called <code>hclustgeo()</code> including spatial/geographical constraints.</p>
<p>In the nutshell, the algorithm uses two dissimilarity matrices D0 and D1 along with a mixing parameter alpha, whereby the value of alpha must be a real number between [0, 1]. D0 can be non-Euclidean and the weights of the observations can be non-uniform. It gives the dissimilarities in the <strong>attribute/clustering variable space</strong>. D1, on the other hand, gives the dissimilarities in the <strong>constraint space</strong>. The criterion minimised at each stage is a convex combination of the homogeneity criterion calculated with D0 and the homogeneity criterion calculated with D1.</p>
<p>The idea is then to determine a value of alpha which increases the spatial contiguity without deteriorating too much the quality of the solution based on the variables of interest. This need is supported by a function called <code>choicealpha()</code>.</p>
<section id="ward-like-hierarchical-clustering-clustgeo." class="level3">
<h3 class="anchored" data-anchor-id="ward-like-hierarchical-clustering-clustgeo.">8.1 Ward-like hierarchical clustering: ClustGeo.</h3>
<p>ClustGeo package provides function called <code>hclustgeo()</code> to perform a typical Ward-like hierarchical clustering just like <code>hclust()</code> you learned in previous section.</p>
<p>To perform non-spatially constrained hierarchical clustering, we only need to provide the function a dissimilarity matrix as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>nongeo_cluster <span class="ot">&lt;-</span> <span class="fu">hclustgeo</span>(proxmat)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nongeo_cluster, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(nongeo_cluster, </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">k =</span> <span class="dv">6</span>, </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that the dissimilarity matrix must be an object of class <code>dist</code>, i.e.&nbsp;an object obtained with the function <code>dist()</code>. For sample code chunk, please refer to <a href="https://r4gdsa.netlify.app/chap05.html#computing-proximity-matrix">5.7.6 Computing proximity matrix</a></p>
</section>
<section id="section-5" class="level3">
<h3 class="anchored" data-anchor-id="section-5"></h3>
</section>
<section id="mapping-the-clusters-formed.-1" class="level3">
<h3 class="anchored" data-anchor-id="mapping-the-clusters-formed.-1">8.2 Mapping the clusters formed.</h3>
<p>Similarly, we can plot the clusters on a categorical area shaded map by using the steps we learned earlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(nongeo_cluster, <span class="at">k=</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>shan_sf_ngeo_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf_final, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_ngeo_cluster, <span class="st">"CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section-6" class="level3">
<h3 class="anchored" data-anchor-id="section-6"></h3>
<section id="section-7" class="level4">
<h4 class="anchored" data-anchor-id="section-7"></h4>
<p>8.2.1 Spatially Constrained Hierarchical Clustering.</p>
<p>Before we can performed spatially constrained hierarchical clustering, a spatial distance matrix will be derived by using <a href="https://r-spatial.github.io/sf/reference/geos_measures.html"><code>st_distance()</code></a> of sf package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(shan_sf_final, shan_sf)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>distmat <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in as.dist.default(dist): non-square matrix</code></pre>
</div>
</div>
<p>Notice that <code>as.dist()</code> is used to convert the data frame into matrix.</p>
<p>Next, <code>choicealpha()</code> will be used to determine a suitable value for the mixing parameter alpha as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>cr <span class="ot">&lt;-</span> <span class="fu">choicealpha</span>(proxmat, distmat, <span class="at">range.alpha =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">K=</span><span class="dv">6</span>, <span class="at">graph =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-64-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>With reference to the graphs above, alpha = 0.3 will be used as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>clustG <span class="ot">&lt;-</span> <span class="fu">hclustgeo</span>(proxmat, distmat, <span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, <code>cutree()</code> is used to derive the cluster objecct.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(clustG, <span class="at">k=</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will then join back the group list with <em>shan_sf</em> polygon feature data frame by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>shan_sf_Gcluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(shan_sf_final, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CLUSTER</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">as.matrix.groups.</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now plot the map of the newly delineated spatially constrained clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(shan_sf_Gcluster, <span class="st">"CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="section-8" class="level2">
<h2 class="anchored" data-anchor-id="section-8"></h2>
<ol start="9" type="1">
<li>Visual Interpretation of Clusters.</li>
</ol>
<p>Code chunk below is used to reveal the distribution of a clustering variable (i.e RADIO_PR) by cluster.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shan_sf_ngeo_cluster,</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> CLUSTER, <span class="at">y =</span> RADIO_PR)) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HandsOn_Ex03_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The boxplot reveals Cluster 1 displays the highest mean Radio Ownership Per Thousand Household. This is followed by Cluster 5,3,2,4 and 6.</p>
<section id="multivariate-visualisation" class="level3">
<h3 class="anchored" data-anchor-id="multivariate-visualisation">9.1 Multivariate Visualisation</h3>
<p>Past studies shown that parallel coordinate plot can be used to reveal clustering variables by cluster very effectively. In the code chunk below, <a href="https://ggobi.github.io/ggally/reference/ggparcoord.html"><code>ggparcoord()</code></a> of <a href="https://ggobi.github.io/ggally/"><strong>GGally</strong></a> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggparcoord(data = shan_sf_ngeo_cluster, </span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co">#           columns = c(17:21), </span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co">#           scale = "globalminmax",</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co">#           alphaLines = 0.2,</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">#           boxplot = TRUE, </span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="co">#           title = "Multiple Parallel Coordinates Plots of ICT Variables by #Cluster") +</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  facet_grid(~ CLUSTER) + </span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  theme(axis.text.x = element_text(angle = 30))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the code chunk below, <code>group_by()</code> and <code>summarise()</code> of dplyr are used to derive mean values of the clustering variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>shan_sf_ngeo_cluster <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CLUSTER) <span class="sc">%&gt;%</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_RADIO_PR =</span> <span class="fu">mean</span>(RADIO_PR),</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_TV_PR =</span> <span class="fu">mean</span>(TV_PR),</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_LLPHONE_PR =</span> <span class="fu">mean</span>(LLPHONE_PR),</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_MPHONE_PR =</span> <span class="fu">mean</span>(MPHONE_PR),</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_COMPUTER_PR =</span> <span class="fu">mean</span>(COMPUTER_PR))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  CLUSTER mean_RADIO_PR mean_TV_PR mean_LLPHONE_PR mean_MPHONE_PR mean_COMPUTE…¹
  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
1 1               347.        451.            25.2          146.           11.8 
2 2               182.        503.            33.5          261.           23.0 
3 3               300.        598.            52.0          389.           29.2 
4 4               124.        249.            15.6           98.1           8.66
5 5               364.        757.            70.6          661.           86.8 
6 6                77.0       621.           100.           512.           37.7 
# … with abbreviated variable name ¹​mean_COMPUTER_PR</code></pre>
</div>
</div>
<section id="section-9" class="level4">
<h4 class="anchored" data-anchor-id="section-9"></h4>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>